<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIP Financial Analysis for Retirement</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f9fafb; color: #1f2937; }
    .container { max-width: 1000px; margin: 0 auto; background-color: #ffffff; padding: 20px 40px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    h1, h2, h3 { color: #111827; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px; margin-top: 24px; }
    h1 { font-size: 1.8em; }
    h2 { font-size: 1.5em; }
    table { width: 100%; border-collapse: collapse; margin: 15px 0; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background-color: #f3f4f6; font-weight: bold; }
    .chart-container { margin: 20px 0; padding: 15px; border: 1px solid #e5e7eb; border-radius: 8px; }
    .callout { padding: 15px; margin: 20px 0; border-left-width: 4px; border-radius: 4px; }
    .callout.warning { border-color: #f59e0b; background-color: #fffbeb; }
    .no-print { display: block; }
    @media print {
      .no-print { display: none; }
      body { margin: 0; padding: 0; }
      .container { box-shadow: none; border-radius: 0; padding: 10px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Systematic Investment Plan (SIP) Financial Analysis for Retirement</h1>

    <section id="executive-summary">
      <h2>üéØ Executive Summary</h2>
      <p>This report outlines a comprehensive financial plan designed to achieve a retirement goal of <b>‚Çπ3,00,00,000</b> over an 11-year time horizon for an individual with a 'moderate' risk appetite. After adjusting for an assumed annual inflation rate of 5.5%, the future value of the target corpus is calculated to be <b>‚Çπ5,40,62,852.75</b>. To reach this goal, a monthly Systematic Investment Plan (SIP) of <b>‚Çπ2,25,746.06</b> is required, based on a projected annual return of 10%. The recommended investment strategy involves a balanced asset allocation of <b>50% in Equity</b> and <b>50% in Debt</b>. While the strategic framework is sound, a critical validation check has identified a discrepancy in the underlying calculation model, where the month-by-month projection falls short of the intended target. This issue is detailed in the report and requires correction for the plan to be fully actionable.</p>
      <div class='callout warning'>‚ö†Ô∏è <strong>Critical Validation Finding:</strong> A mathematical inconsistency was detected in the projection model. The final projected corpus (‚Çπ5,31,27,386.46) is approximately <b>‚Çπ9.35 Lakhs lower</b> than the calculated target (‚Çπ5,40,62,852.75). The plan requires revision to reconcile this shortfall.</div>
    </section>

    <section id='goal-inputs'>
      <h2>üìù Goal Inputs</h2>
      <p>The financial plan is based on the following initial parameters provided by the user.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Financial Goal</td><td>Retirement</td></tr><tr><td>Target Amount (Current Value)</td><td>‚Çπ3,00,00,000</td></tr><tr><td>Time Horizon</td><td>11 Years (132 Months)</td></tr><tr><td>Risk Appetite</td><td>Moderate</td></tr><tr><td>Currency</td><td>INR</td></tr></tbody></table>
    </section>

    <section id='inflation-adjustment'>
      <h2>üìà Inflation Adjustment</h2>
      <p>To maintain purchasing power, the target amount has been adjusted for inflation over the investment period.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Assumed Annual Inflation Rate</td><td>5.5%</td></tr><tr><td>Investment Period</td><td>11 Years</td></tr><tr><td>Unadjusted Target Corpus</td><td>‚Çπ3,00,00,000.00</td></tr><tr><td><b>Inflation-Adjusted Target Corpus</b></td><td><b>‚Çπ5,40,62,852.75</b></td></tr></tbody></table>
    </section>

    <section id='sip-calculation'>
      <h2>üßÆ SIP Calculation Analysis</h2>
      <p>Based on the inflation-adjusted target, the required monthly investment is calculated as follows.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Adjusted Target Corpus (Future Value)</td><td>‚Çπ5,40,62,852.75</td></tr><tr><td>Projected Annual Return (Moderate Risk)</td><td>10.0%</td></tr><tr><td>Equivalent Monthly Return</td><td>0.833%</td></tr><tr><td>Total Investment Months</td><td>132</td></tr><tr><td><b>Required Monthly SIP</b></td><td><b>‚Çπ2,25,746.06</b></td></tr></tbody></table>
    </section>

    <section id='asset-allocation'>
      <h2>‚öñÔ∏è Asset Allocation Plan</h2>
      <p>A balanced asset allocation is recommended to align with the 'moderate' risk profile, aiming for both growth and stability.</p>
      <table><thead><tr><th>Asset Class</th><th>Allocation</th><th>Role in Portfolio</th></tr></thead><tbody><tr><td>Equity</td><td>50%</td><td>Primary engine for capital growth to outperform inflation.</td></tr><tr><td>Debt</td><td>50%</td><td>Provides stability, capital preservation, and predictable returns.</td></tr></tbody></table>
      <h3>Recommended Fund Category Rationale</h3>
      <table><thead><tr><th>Fund Category</th><th>Asset Class</th><th>Role in Portfolio</th><th>Alignment with 'Moderate' Risk Profile</th></tr></thead><tbody><tr><td>Large Cap Funds</td><td>Equity</td><td>Core Growth & Stability</td><td>Provides exposure to established companies with lower volatility than other equity classes, forming a stable foundation for growth.</td></tr><tr><td>Mid Cap Funds</td><td>Equity</td><td>Growth Acceleration</td><td>Offers higher growth potential to help meet the 10% return target. The 11-year horizon is sufficient to tolerate its increased volatility.</td></tr><tr><td>Corporate Bond Funds</td><td>Debt</td><td>Income Enhancement</td><td>Generates higher yields than safer bonds, contributing to overall returns while maintaining a moderate risk level within the debt class.</td></tr><tr><td>Short Duration Funds</td><td>Debt</td><td>Capital Preservation & Stability Anchor</td><td>Minimizes interest rate risk and provides a strong defensive cushion, protecting the portfolio's value during market volatility.</td></tr></tbody></table>
    </section>

    <section id='key-recommendations'>
      <h2>üîë Key Recommendations</h2>
      <ul>
        <li>The proposed 50/50 asset allocation and fund category selection are logically sound and consistent with the stated 'moderate' risk profile and retirement goal.</li>
        <li>It is recommended to proceed with this strategic framework for fund selection once the calculation model is corrected.</li>
        <li><b>Action Required:</b> The underlying calculation engine must be debugged to ensure the month-by-month projection accurately achieves the stated inflation-adjusted target. Do not implement this plan until the shortfall is resolved.</li>
      </ul>
    </section>

    <section id='risk-factors'>
      <h2>üìâ Risk Factors and Uncertainties</h2>
      <p>All financial plans are subject to risks and uncertainties that may impact the final outcome. It is crucial to understand these factors before committing to the investment strategy. This plan is exposed to several specific and general risks:</p>
      <ul>
        <li><b>Calculation Model Integrity (Critical):</b> The most immediate risk is the identified flaw in the projection model. The final projected corpus of <b>‚Çπ5,31,27,386.46</b> is significantly lower than the required target of <b>‚Çπ5,40,62,852.75</b>. This shortfall of over ‚Çπ9.3 Lakhs renders the current plan mathematically unsound. This must be corrected before any investment is made.</li>
        <li><b>Market Risk:</b> The projected 10% annual return is an estimate, not a guarantee. Equity and debt markets are volatile and can experience prolonged periods of underperformance. The 50% allocation to equity, particularly with a Mid Cap component, will expose the portfolio to significant market fluctuations. A severe market downturn could lead to a final corpus that is substantially lower than the projection.</li>
        <li><b>Inflation Risk:</b> The plan assumes a constant 5.5% inflation rate. If actual inflation is higher over the 11-year period, the real value of the final corpus will be lower than anticipated, potentially compromising the retirement goal's purchasing power.</li>
        <li><b>Interest Rate Risk:</b> The debt portion of the portfolio, especially Corporate Bond Funds, is sensitive to changes in interest rates. A rising interest rate environment can lead to a decrease in the value of existing bonds, negatively impacting the portfolio's returns and stability.</li>
        <li><b>Execution Risk:</b> The success of this plan depends on disciplined execution. Failing to invest the required SIP amount consistently every month, or making emotionally-driven decisions to exit investments during market downturns, will severely jeopardize the achievement of the final goal.</li>
      </ul>
    </section>
    
    <section id="sip-charts">
      <h2>üìä SIP Projection & Allocation Charts</h2>
      <div style="display: block;">
        <!-- Asset Allocation FIRST (TOP) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center;">
          <h3>Asset Allocation</h3>
          <div style="max-width: 500px; margin: 0 auto;">
            <canvas id="sipAllocationChart" width="400" height="300" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
        
        <!-- SIP Growth Projection SECOND (BOTTOM) -->
        <div class="chart-container" style="text-align: center;">
          <h3>SIP Growth Projection</h3>
          <div style="max-width: 800px; margin: 0 auto;">
            <canvas id="sipProjectionChart" width="600" height="400" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
      </div>
    </section>

    <section id='monthly-projection'>
      <h2>üóìÔ∏è Monthly Projection (First 12 Months)</h2>
      <p>The table below details the projected growth of the investment corpus over the first year. The full 132-month projection is visualized in the chart above.</p>
      <table>
        <thead><tr><th>Month</th><th>Cumulative Contribution</th><th>Projected Corpus</th></tr></thead>
        <tbody>
          <tr><td>M1</td><td>‚Çπ2,25,746.06</td><td>‚Çπ2,25,746.06</td></tr>
          <tr><td>M2</td><td>‚Çπ4,51,492.12</td><td>‚Çπ4,53,373.34</td></tr>
          <tr><td>M3</td><td>‚Çπ6,77,238.18</td><td>‚Çπ6,82,897.54</td></tr>
          <tr><td>M4</td><td>‚Çπ9,02,984.24</td><td>‚Çπ9,14,334.35</td></tr>
          <tr><td>M5</td><td>‚Çπ11,28,730.30</td><td>‚Çπ11,47,699.51</td></tr>
          <tr><td>M6</td><td>‚Çπ13,54,476.36</td><td>‚Çπ13,83,008.83</td></tr>
          <tr><td>M7</td><td>‚Çπ15,80,222.42</td><td>‚Çπ16,20,278.23</td></tr>
          <tr><td>M8</td><td>‚Çπ18,05,968.48</td><td>‚Çπ18,59,523.69</td></tr>
          <tr><td>M9</td><td>‚Çπ20,31,714.54</td><td>‚Çπ21,00,761.29</td></tr>
          <tr><td>M10</td><td>‚Çπ22,57,460.60</td><td>‚Çπ23,44,007.16</td></tr>
          <tr><td>M11</td><td>‚Çπ24,83,206.66</td><td>‚Çπ25,89,277.58</td></tr>
          <tr><td>M12</td><td>‚Çπ27,08,952.72</td><td>‚Çπ28,36,588.94</td></tr>
        </tbody>
      </table>
    </section>

    <div class="no-print" style="margin: 40px 0; text-align: center;">
      <button onclick="window.print()" style="margin: 5px; padding: 10px 20px; background-color: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">Print Report</button>
      <button onclick="downloadHTML()" style="margin: 5px; padding: 10px 20px; background-color: #10b981; color: white; border: none; border-radius: 6px; cursor: pointer;">Download HTML</button>
    </div>

  </div>

  <!-- Load Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Embed chart data -->
  <script id="sip-chart-data" type="application/json">
  {"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91","M92","M93","M94","M95","M96","M97","M98","M99","M100","M101","M102","M103","M104","M105","M106","M107","M108","M109","M110","M111","M112","M113","M114","M115","M116","M117","M118","M119","M120","M121","M122","M123","M124","M125","M126","M127","M128","M129","M130","M131","M132"],"datasets":{"cumulative_contribution":[225746.06,451492.12,677238.18,902984.24,1128730.3,1354476.36,1580222.42,1805968.48,2031714.54,2257460.6,2483206.66,2708952.72,2934698.78,3160444.84,3386190.9,3611936.96,3837683.02,4063429.08,4289175.14,4514921.2,4740667.26,4966413.32,5192159.38,5417905.44,5643651.5,5869397.56,6095143.62,6320889.68,6546635.74,6772381.8,6998127.86,7223873.92,7449619.98,7675366.04,7901112.1,8126858.16,8352604.22,8578350.28,8804096.34,9029842.4,9255588.46,9481334.52,9707080.58,9932826.64,10158572.7,10384318.76,10610064.82,10835810.88,11061556.94,11287303.0,11513049.06,11738795.12,11964541.18,12190287.24,12416033.3,12641779.36,12867525.42,13093271.48,13319017.54,13544763.6,13770509.66,13996255.72,14222001.78,14447747.84,14673493.9,14899239.96,15124986.02,15350732.08,15576478.14,15802224.2,16027970.26,16253716.32,16479462.38,16705208.44,16930954.5,17156700.56,17382446.62,17608192.68,17833938.74,18059684.8,18285430.86,18511176.92,18736922.98,18962669.04,19188415.1,19414161.16,19639907.22,19865653.28,20091399.34,20317145.4,20542891.46,20768637.52,20994383.58,21220129.64,21445875.7,21671621.76,21897367.82,22123113.88,22348859.94,22574606.0,22800352.06,23026098.12,23251844.18,23477590.24,23703336.3,23929082.36,24154828.42,24380574.48,24606320.54,24832066.6,25057812.66,25283558.72,25509304.78,25735050.84,25960796.9,26186542.96,26412289.02,26638035.08,26863781.14,27089527.2,27315273.26,27541019.32,27766765.38,27992511.44,28218257.5,28444003.56,28669749.62,28895495.68,29121241.74,29346987.8,29572733.86,29798479.92],"projected_corpus":[225746.06,453373.34,682897.54,914334.35,1147699.51,1383008.83,1620278.23,1859523.69,2100761.29,2344007.16,2589277.58,2836588.94,3085957.69,3337400.41,3590933.81,3846574.65,4104339.77,4364246.16,4626310.88,4890551.13,5156984.28,5425627.81,5696499.27,5969616.29,6244996.58,6522658.01,6802618.52,7084896.21,7369509.38,7656476.35,7945815.54,8237545.48,8531684.81,8828252.26,9127266.68,9428747.01,9732712.33,10039181.89,10348174.96,10659710.97,10973809.43,11290489.92,11609772.16,11931676.01,12256221.46,12583428.66,12913317.91,13245909.61,13581224.28,13919282.55,14260105.15,14603712.91,14950126.85,15299368.16,15651458.12,16006418.17,16364269.82,16725034.73,17088734.59,17455391.09,17825026.02,18197661.21,18573318.52,18951999.8,19333726.96,19718522.02,20106407.01,20497404.07,20891535.44,21288823.47,21689290.67,22092959.59,22499853.02,22910003.82,23323435.08,23740169.96,24160231.71,24583643.68,25010429.21,25440611.82,25874215.15,26311263.07,26751779.63,27195788.99,27643315.56,28094383.95,28549018.82,29007245.01,29469087.42,29934571.18,30403721.57,30876564.09,31353124.36,31833428.1,32317501.17,32805369.57,33297059.45,33792597.11,34292008.97,34795321.68,35302562.06,35813757.08,36328933.79,36848119.38,37371341.2,37898626.74,38430003.66,38965499.69,39505142.7,40048960.62,40596981.43,41149233.27,41705744.41,42266543.28,42831658.51,43401118.96,43974953.62,44553191.56,45135862.01,45722994.2,46314617.52,46910761.43,47511455.44,48116729.24,48726612.65,49341135.59,49960328.08,50584219.98,51212841.48,51846222.82,52484394.34,53127386.46]}},"allocation":{"labels":["Equity","Debt"],"data":[50,50],"meta":{"recommended_fund_categories":{"equity":["Large Cap Funds","Mid Cap Funds"],"debt":["Corporate Bond Funds","Short Duration Funds"],"elss_optional":true}}}}
  </script>

  <!-- ENHANCED chart rendering with proper layout and sizing -->
  <script>
  function initCharts() {
    if (typeof Chart === 'undefined') {
      console.error('Chart.js not loaded');
      return;
    }
    
    let data;
    try {
      const script = document.getElementById('sip-chart-data');
      data = script ? JSON.parse(script.textContent) : null;
    } catch (e) {
      console.warn('Chart data parse failed');
      data = null;
    }
    
    // Enhanced fallback with a complete timeline if data is missing
    if (!data) {
      console.warn('Using fallback chart data.');
      data = {
        projection: {
          labels: ["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"],
          datasets: {
            cumulative_contribution: [25000,50000,75000,100000,125000,150000,175000,200000,225000,250000,275000,300000],
            projected_corpus: [25250,50755,76519,102543,128831,155386,182212,209312,236692,264356,292308,320552]
          }
        },
        allocation: { labels: ["Equity", "Debt"], data: [50, 50] }
      };
    }
    
    // Create allocation chart FIRST (TOP POSITION)
    const allocCtx = document.getElementById('sipAllocationChart');
    if (allocCtx) {
      new Chart(allocCtx, {
        type: 'doughnut',
        data: {
          labels: data.allocation.labels,
          datasets: [{ 
            data: data.allocation.data, 
            backgroundColor: ['#3B82F6', '#10B981'],
            borderWidth: 2 
          }]
        },
        options: { 
          responsive: true,
          maintainAspectRatio: true,
          aspectRatio: 1.33,
          plugins: {
            legend: { 
              position: 'bottom',
              labels: { padding: 15 }
            }
          }
        }
      });
    }
    
    // Create projection chart SECOND (BOTTOM POSITION)
    const projCtx = document.getElementById('sipProjectionChart');
    if (projCtx) {
      new Chart(projCtx, {
        type: 'line',
        data: {
          labels: data.projection.labels,
          datasets: [{
            label: 'Projected Corpus',
            data: data.projection.datasets.projected_corpus,
            borderColor: '#3B82F6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            fill: true,
            tension: 0.4,
            pointRadius: 1,
            pointHoverRadius: 4
          }, {
            label: 'Cumulative Contribution', 
            data: data.projection.datasets.cumulative_contribution,
            borderColor: '#EF4444',
            backgroundColor: 'rgba(239, 68, 68, 0.1)',
            fill: false,
            tension: 0.4,
            pointRadius: 1,
            pointHoverRadius: 4
          }]
        },
        options: { 
          responsive: true,
          maintainAspectRatio: true,
          aspectRatio: 1.5,
          interaction: {
            mode: 'nearest',
            intersect: false
          },
          scales: {
            x: {
              title: { display: true, text: 'Time Period (Months)' },
              ticks: { maxTicksLimit: 10 }
            },
            y: {
              beginAtZero: true,
              title: { display: true, text: 'Amount (INR)' },
              ticks: {
                callback: function(value) {
                  if (value >= 10000000) return '‚Çπ' + (value/10000000).toFixed(2) + 'Cr';
                  return '‚Çπ' + (value/100000).toFixed(1) + 'L';
                }
              }
            }
          },
          plugins: {
            tooltip: {
              mode: 'index',
              intersect: false
            }
          }
        }
      });
    }
  }

  // Initialize with a delay for proper loading
  setTimeout(initCharts, 500);
  </script>

  <script>
  function downloadHTML() {
    const html = document.documentElement.outerHTML;
    const blob = new Blob([html], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'sip_comprehensive_report.html';
    a.click();
    URL.revokeObjectURL(url);
  }
  </script>
</body>
</html>