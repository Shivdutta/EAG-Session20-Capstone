<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comprehensive SIP Report for Retirement</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 20px; background-color: #f9fafb; color: #1f2937; }
    .container { max-width: 1200px; margin: 0 auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    h1 { font-size: 2.25rem; font-weight: bold; color: #111827; border-bottom: 2px solid #3B82F6; padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
    h2 { font-size: 1.5rem; font-weight: bold; color: #111827; margin-top: 2rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid #e5e7eb; }
    table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.9rem; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
    th { background-color: #f8f9fa; font-weight: 600; }
    p { line-height: 1.6; margin-bottom: 1rem; }
    ul, ol { margin-left: 1.5rem; margin-bottom: 1rem; }
    li { margin-bottom: 0.5rem; }
    mark { background-color: #bfdbfe; padding: 0.2em 0.4em; border-radius: 3px; }
    .callout.warning { background-color: #fefce8; border-left: 4px solid #facc15; padding: 1rem 1.5rem; margin-bottom: 1.5rem; border-radius: 4px; }
    .executive-summary { background-color: #eff6ff; border-left: 4px solid #3B82F6; padding: 1.5rem; margin-bottom: 2rem; border-radius: 4px; }
    .no-print { display: block; }
    .chart-container { 
      margin: 25px 0; 
      padding: 20px; 
      border: 1px solid #e5e7eb; 
      border-radius: 8px; 
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
    }
    .chart-container h3 { 
      text-align: center; 
      font-size: 1.1rem; 
      font-weight: 600; 
      margin-bottom: 15px; 
      color: #1f2937;
    }
    .chart-container > div {
      margin: 0 auto;
    }
    @media print {
      body { padding: 0; background-color: #fff; -webkit-print-color-adjust: exact; }
      .no-print { display: none; }
      .container { box-shadow: none; border: none; padding: 0.5rem; }
      h1, h2 { margin-top: 1.5rem; }
      .chart-container { 
        page-break-inside: avoid; 
        margin: 15px 0;
      }
      canvas { max-height: 250px !important; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Financial Goal & SIP Analysis for Retirement</h1>
    
    <div style="margin: 20px 0; text-align: center;" class="no-print">
      <button onclick="window.print()" style="margin: 5px; padding: 12px 24px; background-color: #3B82F6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Print Report</button>
      <button onclick="downloadHTML()" style="margin: 5px; padding: 12px 24px; background-color: #10B981; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Download HTML</button>
    </div>

    <section id="executive-summary" class="executive-summary">
      <h2>üéØ Executive Summary</h2>
      <p>This report provides a comprehensive financial plan to achieve the retirement goal of <b>‚Çπ1 Crore</b> (which adjusts to over <b>‚Çπ1.7 Crore</b> after accounting for inflation) over a <b>10-year</b> horizon. Based on a 'moderate' risk profile, the analysis indicates a required monthly Systematic Investment Plan (SIP) of <b>‚Çπ83,387.21</b>. The recommended strategy is a balanced portfolio with a <b>50% allocation to Equity</b> for growth and a <b>50% allocation to Debt</b> for stability. The plan is mathematically sound and strategically aligned with the user's financial objectives and risk tolerance.</p>
      <div class='callout warning'>‚ö†Ô∏è <b>Critical Advisory:</b> While the strategic framework is robust, a critical upstream data retrieval failure prevented the analysis of current market performance for the recommended fund categories. Therefore, the rationale for fund selection is theoretical. <b>It is imperative to resolve this data issue and perform an empirical analysis before committing any capital.</b></div>
    </section>

    <section id='goal-inputs'>
      <h2>üìã Goal Inputs</h2>
      <p>The financial plan is based on the following parameters provided by the user:</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Financial Goal</td><td>Retirement</td></tr><tr><td>Current Age</td><td>50</td></tr><tr><td>Target Retirement Age</td><td>60</td></tr><tr><td>Target Corpus (Today's Value)</td><td>‚Çπ1,00,00,000</td></tr><tr><td>Time Horizon</td><td>10 Years (120 Months)</td></tr><tr><td>Risk Appetite</td><td>Moderate</td></tr></tbody></table>
    </section>

    <section id='inflation-adjustment'>
      <h2>üíπ Inflation Adjustment</h2>
      <p>To ensure future purchasing power, the target corpus has been adjusted for inflation.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Unadjusted Target Corpus</td><td>‚Çπ1,00,00,000</td></tr><tr><td>Assumed Annual Inflation</td><td>5.5%</td></tr><tr><td>Investment Horizon</td><td>10 Years</td></tr><tr><td><b>Inflation-Adjusted Target Corpus</b></td><td><b>‚Çπ1,70,81,444.57</b></td></tr></tbody></table>
    </section>

    <section id='sip-calculation'>
      <h2>üßÆ SIP Calculation</h2>
      <p>The required monthly SIP is calculated to reach the inflation-adjusted target based on the expected returns for a moderate risk profile.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Adjusted Target Corpus</td><td>‚Çπ1,70,81,444.57</td></tr><tr><td>Expected Annual Return</td><td>10.0%</td></tr><tr><td>Investment Duration</td><td>120 Months</td></tr><tr><td><b>Required Monthly SIP</b></td><td><b>‚Çπ83,387.21</b></td></tr></tbody></table>
    </section>

    <section id='asset-allocation'>
      <h2>‚öñÔ∏è Asset Allocation Plan</h2>
      <p>A balanced asset allocation is recommended to align with the 'moderate' risk profile, aiming for growth while managing downside risk.</p>
      <h3>Portfolio Split</h3>
      <table><thead><tr><th>Asset Class</th><th>Allocation</th><th>Primary Role</th></tr></thead><tbody><tr><td>Equity</td><td>50%</td><td>Growth & Wealth Creation</td></tr><tr><td>Debt</td><td>50%</td><td>Stability & Capital Preservation</td></tr></tbody></table>
      <h3>Recommended Fund Category Rationale</h3>
      <table><thead><tr><th>Fund Category</th><th>Asset Class</th><th>Primary Role in Portfolio</th><th>Alignment with User Profile (Moderate Risk, 10-Year Horizon)</th></tr></thead><tbody><tr><td>Large Cap Funds</td><td>Equity</td><td>Core Growth & Stability</td><td>Provides foundational equity exposure with lower volatility, suitable for the risk-averse side of a moderate investor.</td></tr><tr><td>Mid Cap Funds</td><td>Equity</td><td>Growth Acceleration</td><td>Targets higher returns to beat inflation and achieve the goal, with its higher risk balanced by the other 75% of the portfolio.</td></tr><tr><td>Corporate Bond Funds</td><td>Debt</td><td>Income Generation & Stability</td><td>Offers better yields than safer debt to boost returns, while providing a cushion against equity market falls.</td></tr><tr><td>Short Duration Funds</td><td>Debt</td><td>Capital Preservation & Low Volatility</td><td>Acts as a defensive anchor, minimizing interest rate risk and protecting capital as the goal approaches.</td></tr></tbody></table>
    </section>

    <section id='allocation-notes'>
      <h2>üìù Allocation Notes & Risk Profiles</h2>
      <p>The 'Moderate' allocation was chosen from a spectrum of risk-based strategies. The following provides context on the different approaches:</p>
      <ul><li><b>Very Low:</b> Extremely conservative, e.g., 90% debt / 10% equity.</li><li><b>Low:</b> Conservative, e.g., 70% debt / 30% equity.</li><li><b>Low-Moderate:</b> Tilted conservative, e.g., 60% debt / 40% equity.</li><li><b><mark>Moderate:</mark></b> Balanced mix, e.g., 50% equity / 50% debt. <i>(Selected Policy)</i></li><li><b>High-Moderate:</b> Tilted aggressive, e.g., 60% equity / 40% debt.</li><li><b>High:</b> Aggressive, e.g., 70% equity / 30% debt.</li><li><b>Very High:</b> Extremely aggressive, e.g., 90% equity / 10% debt.</li></ul>
    </section>

    <section id='key-recommendations'>
      <h2>üîë Key Recommendations</h2>
      <p>Based on the analysis, the following actions are recommended:</p>
      <ol><li><b>Proceed with the Strategic Framework:</b> The strategic asset allocation of 50% Equity and 50% Debt is well-aligned with the 'moderate' risk profile and 10-year retirement goal. The balanced approach is designed to capture growth while managing risk.</li><li><b>Halt Investment Pending Data Validation:</b> Before making any investments, it is critical to resolve the upstream data retrieval failure. Investment decisions must be informed by up-to-date, quantitative data including returns, risk metrics, and expense ratios. The current fund category analysis is purely theoretical.</li></ol>
    </section>

    <section id='risk-factors'>
      <h2>üìâ Risk Factors and Uncertainties</h2>
      <p>All investments carry risk. It is crucial to understand the potential challenges and uncertainties associated with this financial plan. The following are key risks to consider:</p>
      <ul><li><b>Market Risk:</b> The 10% annual return is a projection, not a guarantee. Equity markets are inherently volatile and can experience significant downturns. A prolonged bear market could impact the final corpus, requiring either a higher SIP contribution or a longer investment horizon. The debt portion of the portfolio is also subject to interest rate risk, where rising rates can decrease the value of existing bonds.</li><li><b>Inflation Risk:</b> The plan assumes an average annual inflation rate of 5.5%. If actual inflation is consistently higher, the real value of the final corpus of ‚Çπ1.71 Crore will be lower than anticipated, potentially leading to a shortfall in retirement purchasing power. This highlights the importance of the equity component, which aims to deliver returns significantly above inflation.</li><li><b>Execution & Behavioral Risk:</b> The success of a SIP plan is heavily dependent on disciplined, consistent investment. Pausing or stopping contributions during market downturns is a common behavioral pitfall that can severely damage long-term returns. It is essential to maintain the investment discipline for the full 120-month period, irrespective of market sentiment.</li><li><b>Data Integrity Risk (Immediate Concern):</b> As highlighted previously, the inability to fetch live market data for fund categories is a critical operational risk. Acting on theoretical assumptions without empirical data can lead to suboptimal fund selection. This risk must be mitigated before any investment action is taken.</li></ul>
      <blockquote>This plan is a roadmap, not a certainty. Regular annual reviews are essential to re-evaluate performance, re-balance the portfolio back to its 50/50 target, and make adjustments based on changing market conditions or personal financial circumstances.</blockquote>
    </section>

    <section id="sip-charts">
      <h2>üìä SIP Projection & Allocation Charts</h2>
      <div style="display: block; max-width: 1000px; margin: 0 auto;">
        <!-- Asset Allocation FIRST (TOP) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
          <h3 style="margin-bottom: 15px;">Asset Allocation</h3>
          <div style="max-width: 500px; margin: 0 auto;">
            <canvas id="sipAllocationChart" width="400" height="300" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
        
        <!-- SIP Growth Projection SECOND (BOTTOM) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
          <h3 style="margin-bottom: 15px;">SIP Growth Projection</h3>
          <div style="max-width: 800px; margin: 0 auto;">
            <canvas id="sipProjectionChart" width="600" height="400" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
      </div>
    </section>
    
    <section id='monthly-projection'>
      <h2>üìà Monthly Projection (First 12 Months)</h2>
      <div class='table-container'><table><thead><tr><th>Month</th><th>Cumulative Contribution</th><th>Projected Corpus</th></tr></thead><tbody><tr><td>M1</td><td>‚Çπ83,387.21</td><td>‚Çπ83,387.21</td></tr><tr><td>M2</td><td>‚Çπ1,66,774.42</td><td>‚Çπ1,67,469.30</td></tr><tr><td>M3</td><td>‚Çπ2,50,161.63</td><td>‚Çπ2,52,252.09</td></tr><tr><td>M4</td><td>‚Çπ3,33,548.84</td><td>‚Çπ3,37,740.85</td></tr><tr><td>M5</td><td>‚Çπ4,16,936.05</td><td>‚Çπ4,23,940.87</td></tr><tr><td>M6</td><td>‚Çπ5,00,323.26</td><td>‚Çπ5,10,857.49</td></tr><tr><td>M7</td><td>‚Çπ5,83,710.47</td><td>‚Çπ5,98,496.08</td></tr><tr><td>M8</td><td>‚Çπ6,67,097.68</td><td>‚Çπ6,86,862.06</td></tr><tr><td>M9</td><td>‚Çπ7,50,484.89</td><td>‚Çπ7,75,960.91</td></tr><tr><td>M10</td><td>‚Çπ8,33,872.10</td><td>‚Çπ8,65,798.15</td></tr><tr><td>M11</td><td>‚Çπ9,17,259.31</td><td>‚Çπ9,56,379.35</td></tr><tr><td>M12</td><td>‚Çπ10,00,646.52</td><td>‚Çπ10,47,710.16</td></tr></tbody></table></div>
      <p><em>Note: Complete projection timeline (120 months) is visualized in the chart above.</em></p>
    </section>
    
    <section id='image-debug'>
      <h2>üñºÔ∏è Image Integration Debug Log</h2>
      <p>No image objects containing 'url' and 'alt_text' fields were found in the session data. The following data structures were scanned for potential images:</p>
      <ul><li>T001.output</li><li>T013.output</li><li>T014.output</li><li>T015.output</li><li>T016.output</li></ul>
    </section>

  </div>

  <script id="chart-data" type="application/json">{"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91","M92","M93","M94","M95","M96","M97","M98","M99","M100","M101","M102","M103","M104","M105","M106","M107","M108","M109","M110","M111","M112","M113","M114","M115","M116","M117","M118","M119","M120"],"datasets":{"cumulative_contribution":[83387.21,166774.42,250161.63,333548.84,416936.05,500323.26,583710.47,667097.68,750484.89,833872.1,917259.31,1000646.52,1084033.73,1167420.94,1250808.15,1334195.36,1417582.57,1500969.78,1584356.99,1667744.2,1751131.41,1834518.62,1917905.83,2001293.04,2084680.25,2168067.46,2251454.67,2334841.88,2418229.09,2501616.3,2585003.51,2668390.72,2751777.93,2835165.14,2918552.35,3001939.56,3085326.77,3168713.98,3252101.19,3335488.4,3418875.61,3502262.82,3585650.03,3669037.24,3752424.45,3835811.66,3919198.87,4002586.08,4085973.29,4169360.5,4252747.71,4336134.92,4419522.13,4502909.34,4586296.55,4669683.76,4753070.97,4836458.18,4919845.39,5003232.6,5086619.81,5170007.02,5253394.23,5336781.44,5420168.65,5503555.86,5586943.07,5670330.28,5753717.49,5837104.7,5920491.91,6003879.12,6087266.33,6170653.54,6254040.75,6337427.96,6420815.17,6504202.38,6587589.59,6670976.8,6754364.01,6837751.22,6921138.43,7004525.64,7087912.85,7171299.9,7254687.21,7338074.42,7421461.63,7504848.84,7588236.05,7671623.26,7755010.47,7838397.68,7921784.89,8005172.1,8088559.31,8171946.52,8255333.73,8338720.94,8422108.15,8505495.36,8588882.57,8672269.78,8755656.99,8839044.2,8922431.41,9005818.62,9089205.83,9172593.04,9255980.25,9339367.46,9422754.67,9506141.88,9589529.09,9672916.3,9756303.51,9839690.72,9923077.93,10006465.14],"projected_corpus":[83387.21,167469.3,252252.09,337740.85,423940.87,510857.49,598496.08,686862.06,775960.91,865798.15,956379.35,1047710.16,1139806.27,1232673.4,1326317.3,1420743.76,1515958.62,1611967.75,1708777.08,1806392.6,1904820.31,2004066.24,2104136.45,2205037.05,2306774.2,2409354.12,2512783.09,2617067.43,2722213.49,2828227.69,2935116.58,3042886.75,3151544.86,3261097.6,3371551.74,3482914.13,3595191.68,3708391.35,3822520.15,3937585.16,4053593.53,4170552.51,4288469.45,4407351.71,4527206.69,4648041.8,4769864.48,4892682.35,5016503.07,5141334.33,5267183.85,5394059.38,5521968.72,5650919.67,5780920.07,5911977.78,6044100.7,6177296.71,6311573.74,6446939.73,6583402.66,6720970.52,6859651.3,7000053.07,7141183.94,7283052.14,7425666.01,7569033.91,7713164.26,7858065.62,8003746.54,8150215.68,8297481.65,8445553.16,8594438.9,8744147.59,8894688.02,9046068.99,9198299.36,9351388.02,9505343.92,9660175.98,9815893.12,9972504.26,10130018.3,10288444.15,10447790.82,10608067.28,10769282.52,10931445.54,11094565.35,11258650.96,11423711.38,11589755.65,11756792.83,11924831.98,12093882.24,12263952.62,12435052.26,12607189.36,12780372.17,12954609.1,13129908.64,13306279.25,13483729.41,13662267.62,13841902.48,14022642.66,14204496.85,14387473.8,14571582.28,14756831.13,14943229.22,15130785.46,15319508.8,15509408.2,15700492.64,15892771.08,16086252.51,16280946.04]}},"allocation":{"labels":["Equity","Debt"],"data":[50,50],"meta":{"recommended_fund_categories":{"equity":["Large Cap Funds","Mid Cap Funds"],"debt":["Corporate Bond Funds","Short Duration Funds"],"elss_optional":true}}}}</script>
  
  <script>
    function downloadHTML() {
      const html = document.documentElement.outerHTML;
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'comprehensive_report.html';
      a.click();
      URL.revokeObjectURL(url);
    }

    function initCharts() {
      if (typeof Chart === 'undefined') {
        console.error('Chart.js not loaded');
        return;
      }
      
      let data;
      try {
        const script = document.getElementById('chart-data');
        data = script ? JSON.parse(script.textContent) : null;
      } catch (e) {
        console.warn('Chart data parse failed');
        data = null;
      }
      
      if (!data) {
        console.error('Could not load chart data.');
        return;
      }
      
      // Create allocation chart FIRST (TOP POSITION)
      const allocCtx = document.getElementById('sipAllocationChart');
      if (allocCtx) {
        new Chart(allocCtx, {
          type: 'doughnut',
          data: {
            labels: data.allocation.labels,
            datasets: [{ 
              data: data.allocation.data, 
              backgroundColor: ['#3B82F6', '#10B981'],
              borderWidth: 2 
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.33,
            plugins: {
              legend: { 
                position: 'bottom',
                labels: { padding: 15 }
              }
            }
          }
        });
      }
      
      // Create projection chart SECOND (BOTTOM POSITION)
      const projCtx = document.getElementById('sipProjectionChart');
      if (projCtx) {
        new Chart(projCtx, {
          type: 'line',
          data: {
            labels: data.projection.labels,
            datasets: [{
              label: 'Projected Corpus',
              data: data.projection.datasets.projected_corpus,
              borderColor: '#3B82F6',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              fill: true,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }, {
              label: 'Cumulative Contribution', 
              data: data.projection.datasets.cumulative_contribution,
              borderColor: '#EF4444',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              fill: false,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.5,
            interaction: {
              mode: 'nearest',
              intersect: false
            },
            scales: {
              x: {
                title: { display: true, text: 'Time Period (Months)' },
                ticks: { maxTicksLimit: 10 }
              },
              y: {
                beginAtZero: true,
                title: { display: true, text: 'Amount (INR)' },
                ticks: {
                  callback: function(value) {
                    return '‚Çπ' + (value/100000).toFixed(1) + 'L';
                  }
                }
              }
            },
            plugins: {
              tooltip: {
                mode: 'index',
                intersect: false
              }
            }
          }
        });
      }
    }

    // Initialize with enhanced delay for proper loading
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => setTimeout(initCharts, 300));
    } else {
        setTimeout(initCharts, 300);
    }
  </script>

</body>
</html>