<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comprehensive Retirement SIP Analysis Report</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f9fafb; }
    .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    h1 { font-size: 2em; font-weight: bold; color: #111827; margin-bottom: 1rem; }
    h2 { font-size: 1.5em; font-weight: bold; color: #1f2937; margin-top: 1.5rem; margin-bottom: 0.75rem; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.5rem; }
    table { width: 100%; border-collapse: collapse; margin: 15px 0; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background-color: #f8f9fa; font-weight: bold; }
    .callout { padding: 15px; margin: 15px 0; border-left-width: 4px; border-radius: 4px; }
    .callout.warning { border-color: #f59e0b; background-color: #fffbeb; }
    .callout h4 { font-weight: bold; margin-top: 0; }
    .no-print { display: block; }
    @media print { 
      .no-print { display: none; } 
      body { background-color: white; box-shadow: none; }
      .container { box-shadow: none; padding: 0; border: none; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Comprehensive Retirement SIP Analysis Report</h1>

    <section id="executive-summary">
      <h2>üéØ Executive Summary</h2>
      <p>This report details a Systematic Investment Plan (SIP) designed to achieve a retirement goal of <b>‚Çπ3,00,00,000</b> (in today's value) over a <b>10-year period</b>. After adjusting for an assumed annual inflation of 5.5%, the future value required is approximately <b>‚Çπ5,12,44,334</b>. Based on a moderate risk profile with an expected annual return of 10%, the plan calculates a required monthly SIP of <b>‚Çπ2,50,161</b>. The recommended asset allocation is a balanced <b>50% in Equity and 50% in Debt</b>.</p>
      <div class='callout warning'>
        <p><b>‚ö†Ô∏è Critical Findings & Required Actions:</b> This plan is <b>not ready for implementation</b> due to two critical issues identified during validation.</p>
        <ul>
          <li><b>1. Calculation Shortfall:</b> A mathematical inconsistency was discovered. The calculated monthly SIP of ‚Çπ2,50,161 results in a final projected corpus of ‚Çπ5,07,46,114, which is approximately <b>‚Çπ4,98,000 short</b> of the inflation-adjusted target. The monthly SIP amount must be recalculated and corrected.</li>
          <li><b>2. Incomplete Fund Availability:</b> The process to identify suitable mutual funds failed for two of the four required categories. No options were found for 'Mid Cap Funds' and 'Short Duration Funds'. Proceeding would result in a misaligned portfolio that does not match the intended strategy.</li>
        </ul>
        <p><b>Primary Recommendation:</b> The plan must be revised. The SIP calculation needs to be corrected, and the fund sourcing process must be re-executed to find options for the missing categories before any investment is made.</p>
      </div>
    </section>

    <section id="goal-inputs">
      <h2>üìù Goal Inputs</h2>
      <p>The investment plan is based on the following user-defined parameters.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td><b>Goal Type</b></td><td>Retirement</td></tr><tr><td><b>Target Amount (Current Value)</b></td><td>‚Çπ3,00,00,000</td></tr><tr><td><b>Time Horizon</b></td><td>10 Years (120 Months)</td></tr><tr><td><b>Risk Appetite</b></td><td>Moderate</td></tr><tr><td><b>Currency</b></td><td>INR</td></tr></tbody></table>
    </section>

    <section id="inflation-adjustment">
      <h2>üíπ Inflation Adjustment</h2>
      <p>To maintain purchasing power, the target amount has been adjusted for future inflation.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td><b>Assumed Annual Inflation Rate</b></td><td>5.5%</td></tr><tr><td><b>Unadjusted Target Amount</b></td><td>‚Çπ3,00,00,000</td></tr><tr><td><b>Inflation-Adjusted Target (Future Value)</b></td><td><b>‚Çπ5,12,44,333.72</b></td></tr></tbody></table>
    </section>

    <section id="sip-calculation">
      <h2>üßÆ SIP Calculation & Validation</h2>
      <p>The following monthly SIP was calculated to reach the adjusted target based on the selected risk profile.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td><b>Expected Annual Return (Moderate Risk)</b></td><td>10.0%</td></tr><tr><td><b>Calculated Monthly SIP</b></td><td>‚Çπ2,50,161.43</td></tr><tr><td><b>Total Contributions over 10 Years</b></td><td>‚Çπ3,00,19,371.60</td></tr><tr><td><b>Projected Final Corpus</b></td><td>‚Çπ5,07,46,114.45</td></tr></tbody></table>
      <div class='callout warning'>
        <h4>‚ö†Ô∏è Critical Calculation Error</h4>
        <p>As confirmed by the validation process, the calculated `monthly_sip` is insufficient. The final projected corpus of <b>‚Çπ5,07,46,114.45</b> falls short of the required inflation-adjusted target of <b>‚Çπ5,12,44,333.72</b> by approximately <b>‚Çπ4,98,219</b>. This mathematical error undermines the entire plan and must be corrected by re-calculating the monthly SIP to ensure the goal is met.</p>
      </div>
    </section>

    <section id="asset-allocation">
      <h2>‚öñÔ∏è Asset Allocation Plan</h2>
      <p>Based on a 'moderate' risk appetite, a balanced allocation between equity and debt is recommended to achieve growth while managing downside risk.</p>
      <table><thead><tr><th>Asset Class</th><th>Allocation</th><th>Recommended Fund Categories</th><th>Status</th></tr></thead><tbody><tr><td>Equity</td><td><b>50%</b></td><td>Large Cap Funds, Mid Cap Funds</td><td>Partially Covered</td></tr><tr><td>Debt</td><td><b>50%</b></td><td>Corporate Bond Funds, Short Duration Funds</td><td>Partially Covered</td></tr></tbody></table>
      <div class='callout warning'>
        <h4>‚ö†Ô∏è Fund Sourcing Gaps Identified</h4>
        <p>The fund reconciliation process found that the shortlist of available mutual funds is incomplete. While suitable options were found for 'Large Cap Funds' and 'Corporate Bond Funds', data retrieval failed for 'Mid Cap Funds' and 'Short Duration Funds'. This represents a critical implementation gap. The portfolio cannot be constructed as designed without sourcing funds for these missing categories.</p>
      </div>
    </section>

    <section id="key-recommendations">
      <h2>üîë Key Recommendations</h2>
      <p>This plan requires immediate revision. The following actions are mandatory before proceeding:</p>
      <ol class="list-decimal list-inside">
        <li class="mb-2"><b>Correct the SIP Calculation:</b> The highest priority is to resolve the mathematical error. The monthly SIP amount must be recalculated and increased to a level that ensures the final projected corpus meets or slightly exceeds the ‚Çπ5.12 Cr inflation-adjusted target.</li>
        <li class="mb-2"><b>Re-run Fund Sourcing:</b> Trigger a new data retrieval process specifically to find high-quality 'Mid Cap Funds' and 'Short Duration Funds'. The current gaps prevent the creation of a diversified portfolio aligned with the strategic plan.</li>
        <li class="mb-2"><b>Do Not Invest:</b> No capital should be deployed based on this preliminary plan. Investing with an incorrect SIP amount and an incomplete asset allocation would introduce significant risk of missing the financial goal.</li>
      </ol>
    </section>

    <section id="risk-factors">
      <h2>üìâ Risk Factors and Uncertainties</h2>
      <p>All investments carry risk. Beyond the specific plan flaws already identified, investors should be aware of several broader uncertainties that can impact the final outcome. The expected 10% annual return is a long-term average and is not guaranteed; actual returns will fluctuate with market conditions. <b>Market Risk</b> is significant, as the 50% equity allocation will be exposed to stock market volatility, which can lead to periods of negative returns. The plan's success is highly dependent on the <b>Discipline of the Investor</b> to consistently contribute the required monthly amount for the full 120-month period without interruption, which can be challenged by life events or changing financial circumstances. Furthermore, <b>Inflation Risk</b> remains a key concern; if the actual rate of inflation over the next decade exceeds the 5.5% assumption, the real-terms purchasing power of the final ‚Çπ5.12 Cr corpus will be lower than anticipated. Finally, there is a clear <b>Implementation Risk</b>, highlighted by the failure to source funds for all necessary categories. An improperly constructed portfolio, lacking the growth potential of mid-cap stocks and the specific risk profile of short-duration bonds, will not perform as designed and introduces concentration risk.</p>
    </section>

    <!-- FIXED CHART LAYOUT (v11+) -->
    <section id="sip-charts">
      <h2>üìä SIP Projection & Allocation Charts</h2>
      <div style="display: block;">
        <!-- Asset Allocation FIRST (TOP) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center;">
          <h3>Asset Allocation</h3>
          <div style="max-width: 500px; margin: 0 auto;">
            <canvas id="sipAllocationChart" width="400" height="300" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
        
        <!-- SIP Growth Projection SECOND (BOTTOM) -->
        <div class="chart-container" style="text-align: center;">
          <h3>SIP Growth Projection</h3>
          <div style="max-width: 800px; margin: 0 auto;">
            <canvas id="sipProjectionChart" width="600" height="400" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
      </div>
    </section>

    <section id="monthly-projection">
      <h2>üìà Monthly Projection (First 12 Months)</h2>
      <table><thead><tr><th>Month</th><th>Cumulative Contribution</th><th>Projected Corpus</th></tr></thead><tbody><tr><td>M1</td><td>‚Çπ2,50,161.43</td><td>‚Çπ2,50,161.43</td></tr><tr><td>M2</td><td>‚Çπ5,00,322.86</td><td>‚Çπ5,02,407.54</td></tr><tr><td>M3</td><td>‚Çπ7,50,484.29</td><td>‚Çπ7,56,752.37</td></tr><tr><td>M4</td><td>‚Çπ10,00,645.72</td><td>‚Çπ10,13,214.30</td></tr><tr><td>M5</td><td>‚Çπ12,50,807.15</td><td>‚Çπ12,71,811.75</td></tr><tr><td>M6</td><td>‚Çπ15,00,968.58</td><td>‚Çπ15,32,563.18</td></tr><tr><td>M7</td><td>‚Çπ17,51,130.01</td><td>‚Çπ17,95,487.18</td></tr><tr><td>M8</td><td>‚Çπ20,01,291.44</td><td>‚Çπ20,60,602.41</td></tr><tr><td>M9</td><td>‚Çπ22,51,452.87</td><td>‚Çπ23,27,927.56</td></tr><tr><td>M10</td><td>‚Çπ25,01,614.30</td><td>‚Çπ25,97,481.56</td></tr><tr><td>M11</td><td>‚Çπ27,51,775.73</td><td>‚Çπ28,69,283.43</td></tr><tr><td>M12</td><td>‚Çπ30,01,937.16</td><td>‚Çπ31,43,352.26</td></tr></tbody></table>
    </section>

    <div class="no-print" style="margin: 40px 0; text-align: center; border-top: 2px solid #e5e7eb; padding-top: 20px;">
      <button onclick="window.print()" style="margin: 5px; padding: 10px 20px; background-color: #3B82F6; color: white; border: none; border-radius: 5px; cursor: pointer;">Print Report</button>
      <button onclick="downloadHTML()" style="margin: 5px; padding: 10px 20px; background-color: #10B981; color: white; border: none; border-radius: 5px; cursor: pointer;">Download HTML</button>
    </div>

  </div>

  <!-- Load Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Embed chart data -->
  <script id="sip-chart-data" type="application/json">
  {"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91","M92","M93","M94","M95","M96","M97","M98","M99","M100","M101","M102","M103","M104","M105","M106","M107","M108","M109","M110","M111","M112","M113","M114","M115","M116","M117","M118","M119","M120"],"datasets":{"cumulative_contribution":[250161.43,500322.86,750484.29,1000645.72,1250807.15,1500968.58,1751130.01,2001291.44,2251452.87,2501614.3,2751775.73,3001937.16,3252098.59,3502260.02,3752421.45,4002582.88,4252744.31,4502905.74,4753067.17,5003228.6,5253390.03,5503551.46,5753712.89,6003874.32,6254035.75,6504197.18,6754358.61,7004520.04,7254681.47,7504842.9,7755004.33,8005165.76,8255327.19,8505488.62,8755650.05,9005811.48,9255972.91,9506134.34,9756295.77,10006457.2,10256618.63,10506780.06,10756941.49,11007102.92,11257264.35,11507425.78,11757587.21,12007748.64,12257910.07,12508071.5,12758232.93,13008394.36,13258555.79,13508717.22,13758878.65,14009040.08,14259201.51,14509362.94,14759524.37,15009685.8,15259847.23,15510008.66,15760170.09,16010331.52,16260492.95,16510654.38,16760815.81,17010977.24,17261138.67,17511300.1,17761461.53,18011622.96,18261784.39,18511945.82,18762107.25,19012268.68,19262430.11,19512591.54,19762752.97,20012914.4,20263075.83,20513237.26,20763398.69,21013560.12,21263721.55,21513882.98,21764044.41,22014205.84,22264367.27,22514528.7,22764690.13,23014851.56,23265012.99,23515174.42,23765335.85,24015497.28,24265658.71,24515820.14,24765981.57,25016143.0,25266304.43,25516465.86,25766627.29,26016788.72,26266950.15,26517111.58,26767273.01,27017434.44,27267595.87,27517757.3,27767918.73,28018080.16,28268241.59,28518403.02,28768564.45,29018725.88,29268887.31,29519048.74,29769210.17,30019371.6],"projected_corpus":[250161.43,502407.54,756752.37,1013214.3,1271811.75,1532563.18,1795487.18,2060602.41,2327927.56,2597481.56,2869283.43,3143352.26,3419707.23,3698367.62,3979352.7,4262681.77,4548374.15,4836449.27,5126926.68,5419826.04,5715167.09,6012969.58,6313253.33,6616038.27,6921344.42,7229191.95,7539601.21,7852592.59,8168186.56,8486403.75,8807264.81,9130790.49,9457001.74,9785919.59,10117565.25,10451960.1,10789125.77,11129084.15,11471857.19,11817466.83,12165935.19,12517284.45,12871536.82,13228714.63,13588840.29,13951936.32,14318025.32,14687129.87,15059272.62,15434476.22,15812763.52,16194157.55,16578681.4,16966358.11,17357210.83,17751262.75,18148537.14,18549057.28,18952846.59,19359928.64,19770327.05,20184065.51,20601167.72,21021657.48,2144558.62,21872895.11,22303690.93,22737970.19,23175757.1,23617076.08,24061951.71,24510408.64,24962471.55,25418165.21,25877514.42,26340544.07,26807279.14,27277744.6,27751965.47,28229966.85,28711773.91,29197411.89,29686906.02,30180281.57,30677563.92,31178778.62,31683951.11,32193107.03,32706272.09,33223472.09,33744732.99,34270080.76,34799541.43,35333141.01,35870905.52,36412861.03,36959033.61,37509449.42,38064134.66,38623115.62,39186418.59,39754069.94,40326096.19,40902524.02,41483380.25,42068691.75,42658485.52,43252788.59,43851628.16,44455031.55,45063026.15,45675639.36,46292898.69,46914831.68,47541465.94,48172828.16,48808945.06,49449843.3,50095551.52,50746114.45]}},"allocation":{"labels":["Equity","Debt"],"data":[50,50],"meta":{"recommended_fund_categories":{"equity":["Large Cap Funds","Mid Cap Funds"],"debt":["Corporate Bond Funds","Short Duration Funds"],"elss_optional":true}}}}
  </script>

  <!-- ENHANCED chart rendering with proper layout and sizing -->
  <script>
  function initCharts() {
    if (typeof Chart === 'undefined') {
      console.error('Chart.js not loaded');
      return;
    }
    
    let data;
    try {
      const script = document.getElementById('sip-chart-data');
      data = script ? JSON.parse(script.textContent) : null;
    } catch (e) {
      console.warn('Chart data parse failed');
      data = null;
    }
    
    // Enhanced fallback with complete timeline
    if (!data) {
      data = {
        projection: {
          labels: ["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91","M92","M93","M94","M95","M96","M97","M98","M99","M100","M101","M102","M103","M104","M105","M106","M107","M108","M109","M110","M111","M112","M113","M114","M115","M116","M117","M118","M119","M120"],
          datasets: {
            cumulative_contribution: [25000,50000,75000,100000,125000,150000,175000,200000,225000,250000,275000,300000,325000,350000,375000,400000,425000,450000,475000,500000,525000,550000,575000,600000,625000,650000,675000,700000,725000,750000,775000,800000,825000,850000,875000,900000,925000,950000,975000,1000000,1025000,1050000,1075000,1100000,1125000,1150000,1175000,1200000,1225000,1250000,1275000,1300000,1325000,1350000,1375000,1400000,1425000,1450000,1475000,1500000,1525000,1550000,1575000,1600000,1625000,1650000,1675000,1700000,1725000,1750000,1775000,1800000,1825000,1850000,1875000,1900000,1925000,1950000,1975000,2000000,2025000,2050000,2075000,2100000,2125000,2150000,2175000,2200000,2225000,2250000,2275000,2300000,2325000,2350000,2375000,2400000,2425000,2450000,2475000,2500000,2525000,2550000,2575000,2600000,2625000,2650000,2675000,2700000,2725000,2750000,2775000,2800000,2825000,2850000,2875000,2900000,2925000,2950000,2975000,3000000],
            projected_corpus: [25250,50755,76519,102543,128831,155386,182212,209312,236692,264356,292308,320552,349093,377935,407082,436540,466312,496404,526821,557567,588648,620068,651832,683945,716412,749239,782430,815991,849927,884244,918948,954045,989540,1025440,1061750,1098476,1135626,1173205,1211220,1249678,1288586,1327951,1367780,1408080,1448859,1490125,1531885,1574148,1616922,1660215,1704035,1748392,1793293,1838750,1884770,1931365,1978544,2026318,2074697,2123692,2173315,2223577,2274490,2326066,2378316,2431252,2484887,2539233,2594302,2650106,2706658,2763971,2822058,2880932,2940607,3001097,3062415,3124575,3187591,3251477,3316247,3381916,3448499,3516010,3584465,3653879,3724267,3795645,3868028,3941432,4015873,4091366,4167928,4245574,4324322,4404188,4485188,4567340,4650661,4735168,4821880,4909814,4999990,5091425,5184139,5278150,5373478,5470142,5568161,5667556,5768346,5870552,5974194,6079293,6185870,6293947,6403545,6514686,6627391]
          }
        },
        allocation: { labels: ["Equity", "Debt"], data: [70, 30] }
      };
    }
    
    // Create allocation chart FIRST (TOP POSITION)
    const allocCtx = document.getElementById('sipAllocationChart');
    if (allocCtx) {
      new Chart(allocCtx, {
        type: 'doughnut',
        data: {
          labels: data.allocation.labels,
          datasets: [{ 
            data: data.allocation.data, 
            backgroundColor: ['#3B82F6', '#10B981'],
            borderWidth: 2 
          }]
        },
        options: { 
          responsive: true,
          maintainAspectRatio: true,
          aspectRatio: 1.33,
          plugins: {
            legend: { 
              position: 'bottom',
              labels: { padding: 15 }
            }
          }
        }
      });
    }
    
    // Create projection chart SECOND (BOTTOM POSITION)
    const projCtx = document.getElementById('sipProjectionChart');
    if (projCtx) {
      new Chart(projCtx, {
        type: 'line',
        data: {
          labels: data.projection.labels,
          datasets: [{
            label: 'Projected Corpus',
            data: data.projection.datasets.projected_corpus,
            borderColor: '#3B82F6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            fill: true,
            tension: 0.4,
            pointRadius: 1,
            pointHoverRadius: 4
          }, {
            label: 'Cumulative Contribution', 
            data: data.projection.datasets.cumulative_contribution,
            borderColor: '#EF4444',
            backgroundColor: 'rgba(239, 68, 68, 0.1)',
            fill: false,
            tension: 0.4,
            pointRadius: 1,
            pointHoverRadius: 4
          }]
        },
        options: { 
          responsive: true,
          maintainAspectRatio: true,
          aspectRatio: 1.5,
          interaction: {
            mode: 'nearest',
            intersect: false
          },
          scales: {
            x: {
              title: { display: true, text: 'Time Period (Months)' },
              ticks: { maxTicksLimit: 10 }
            },
            y: {
              beginAtZero: true,
              title: { display: true, text: 'Amount (INR)' },
              ticks: {
                callback: function(value) {
                  if (value >= 10000000) return '‚Çπ' + (value/10000000).toFixed(2) + 'Cr';
                  return '‚Çπ' + (value/100000).toFixed(1) + 'L';
                }
              }
            }
          },
          plugins: {
            tooltip: {
              mode: 'index',
              intersect: false
            }
          }
        }
      });
    }
  }

  // Initialize with enhanced delay for proper loading
  setTimeout(initCharts, 500);
  </script>

  <script>
  function downloadHTML() {
    const html = document.documentElement.outerHTML;
    const blob = new Blob([html], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'sip_comprehensive_report.html';
    a.click();
    URL.revokeObjectURL(url);
  }
  </script>
</body>
</html>