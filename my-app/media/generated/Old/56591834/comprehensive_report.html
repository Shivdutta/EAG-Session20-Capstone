<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive SIP Analysis Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .report {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        .report h1 {
            font-size: 2em;
            margin-bottom: 20px;
        }
        .report h2 {
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 10px;
        }
        .report p {
            margin-bottom: 15px;
        }
        .report ul {
            margin-bottom: 15px;
        }
        .report li {
            margin-left: 20px;
        }
        .report table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .report th, .report td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .report th {
            background-color: #f2f2f2;
        }
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .chart-container {
            width: 100%;
            height: 400px;
        }
        .table-container {
            overflow-x: auto;
        }
        /* Print styles */
        @media print {
            body {
                font-size: 12pt;
            }
            .report {
                margin: 0;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="report">
        <h1 id="comprehensive-sip-analysis-report" class="text-2xl font-bold mb-4">üìä COMPREHENSIVE SIP ANALYSIS REPORT</h1>

        <section id="executive_summary" class="mb-8">
            <h2 id="executive-summary" class="text-xl font-semibold mb-2">üéØ Executive Summary</h2>
            <p>This report provides a comprehensive analysis of a Systematic Investment Plan (SIP) designed for a retirement goal with a high-risk appetite. The goal is to accumulate ‚Çπ30,000,000 (unadjusted for inflation) over a 10-year period. The report includes an inflation adjustment, SIP calculation, asset allocation plan, and a detailed projection of the investment's growth. The recommended allocation is 70% equity and 30% debt, with specific fund categories identified for each asset class. The report also includes a 12-month SIP projection table and interactive charts illustrating the projected corpus and asset allocation.</p>
        </section>

        <section id="goal_inputs" class="mb-8">
            <h2 id="goal-inputs" class="text-xl font-semibold mb-2">üéØ Goal Inputs</h2>
            <p>The following inputs were used to calculate the SIP plan:</p>
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Goal Type</td>
                        <td>Retirement</td>
                    </tr>
                    <tr>
                        <td>Target Amount</td>
                        <td>‚Çπ30,000,000</td>
                    </tr>
                    <tr>
                        <td>Time Horizon</td>
                        <td>10 years (120 months)</td>
                    </tr>
                    <tr>
                        <td>Risk Appetite</td>
                        <td>High</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="inflation_adjustment" class="mb-8">
            <h2 id="inflation-adjustment" class="text-xl font-semibold mb-2">üí∞ Inflation Adjustment</h2>
            <p>To account for inflation, the target amount was adjusted using an inflation rate of 5.5% per year.</p>
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Inflation Rate</td>
                        <td>5.5%</td>
                    </tr>
                    <tr>
                        <td>Time Horizon</td>
                        <td>10 years</td>
                    </tr>
                    <tr>
                        <td>Unadjusted Target</td>
                        <td>‚Çπ30,000,000</td>
                    </tr>
                    <tr>
                        <td>Adjusted Target</td>
                        <td>‚Çπ51,265,785.16</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="sip_calculation" class="mb-8">
            <h2 id="sip-calculation" class="text-xl font-semibold mb-2">üßÆ SIP Calculation</h2>
            <p>Based on the adjusted target and the assumed monthly return, the required monthly SIP amount was calculated.</p>
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Monthly Return (r)</td>
                        <td>1.0%</td>
                    </tr>
                    <tr>
                        <td>Number of Months (n)</td>
                        <td>120</td>
                    </tr>
                    <tr>
                        <td>Adjusted Target</td>
                        <td>‚Çπ51,265,785.16</td>
                    </tr>
                    <tr>
                        <td>Monthly SIP Amount</td>
                        <td>‚Çπ251,055.93</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="asset_allocation_plan" class="mb-8">
            <h2 id="asset-allocation-plan" class="text-xl font-semibold mb-2">üìä Asset Allocation Plan</h2>
            <p>The recommended asset allocation is based on a high-risk appetite, with a focus on maximizing returns while managing risk.</p>
            <table>
                <thead>
                    <tr>
                        <th>Asset Class</th>
                        <th>Percentage</th>
                        <th>Recommended Fund Categories</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Equity</td>
                        <td>70%</td>
                        <td>Large Cap Funds, Mid Cap Funds, Small Cap Funds</td>
                    </tr>
                    <tr>
                        <td>Debt</td>
                        <td>30%</td>
                        <td>Corporate Bond Funds, Short Duration Funds, Liquid Funds, Government Securities</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="allocation_notes" class="mb-8">
            <h2 id="allocation-notes" class="text-xl font-semibold mb-2">üìù Allocation Notes</h2>
            <p>The following notes provide guidance on asset allocation based on different risk appetites:</p>
            <ul>
                <li><b>Very Low:</b> Extremely conservative (90% debt / 10% equity)</li>
                <li><b>Low:</b> Conservative (70% debt / 30% equity)</li>
                <li><b>Low-Moderate:</b> Tilted conservative (60% debt / 40% equity)</li>
                <li><b>Moderate:</b> Balanced mix (50% equity / 50% debt)</li>
                <li><b>High-Moderate:</b> Tilted aggressive (60% equity / 40% debt)</li>
                <li><b>High:</b> Aggressive (70% equity / 30% debt)</li>
                <li><b>Very High:</b> Extremely aggressive (90% equity / 10% equity)</li>
            </ul>
        </section>

        <section id="key_recommendations" class="mb-8">
            <h2 id="key-recommendations" class="text-xl font-semibold mb-2">üîë Key Recommendations</h2>
            <p>Based on the analysis, the following recommendations are made:</p>
            <ul>
                <li>Obtain complete fund data from the source URLs provided in T012 or use a dedicated financial data API.</li>
                <li>Verify fund data, including expense ratios and performance metrics, from reliable sources.</li>
                <li>Consider factors such as fund manager experience and risk-adjusted returns before making final investment decisions.</li>
                <li>Regularly review and rebalance the portfolio to maintain the target asset allocation percentages.</li>
            </ul>
        </section>

        <section id="risk_factors_uncertainties" class="mb-8">
            <h2 id="risk-factors-uncertainties" class="text-xl font-semibold mb-2">‚ö†Ô∏è Risk Factors and Uncertainties</h2>
            <p>Investing in financial markets involves inherent risks and uncertainties. The following factors should be considered:</p>
            <ul>
                <li><b>Market Risk:</b> Equity funds are subject to market risk, which can lead to fluctuations in the value of the investment. The returns listed are historical and not guarantees of future performance.</li>
                <li><b>Interest Rate Risk:</b> Debt funds, particularly corporate bond funds, are subject to interest rate risk. Rising interest rates can negatively impact the value of these funds.</li>
                <li><b>Credit Risk:</b> Corporate bond funds are subject to credit risk, which is the risk that the issuer of the bond may default on its payments.</li>
                <li><b>Inflation Risk:</b> Unexpected inflation can erode the real value of returns, impacting the achievement of the target corpus.</li>
                <li><b>Data Accuracy:</b> The accuracy of the fund data in T012 cannot be guaranteed. Verify all data with reliable sources before making investment decisions. The returns and other information cited from the notes in T012 must be viewed cautiously and verified from primary sources.</li>
            </ul>
            <p><b>Mitigation Strategies:</b> Diversification across asset classes and fund categories can help mitigate market risk. Regularly reviewing and rebalancing the portfolio can help maintain the target asset allocation and adjust to changing market conditions. Conducting thorough due diligence on individual funds and verifying data from reliable sources can help mitigate credit risk and data accuracy risks.</p>
            <p><b>Disclaimer:</b> The information in this report is for informational purposes only and should not be considered investment advice. Consult with a qualified financial advisor before making any investment decisions.</p>
        </section>
        
        <section id="sip-charts" class="mb-8">
            <h2 id="sip-charts" class="text-xl font-semibold mb-2">üìä SIP Projection & Allocation Charts</h2>
            <div class="charts-grid">
                <div class="chart-container">
                    <h3>SIP Growth Projection</h3>
                    <canvas id="sipProjectionChart" width="400" height="300"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Asset Allocation</h3>
                    <canvas id="sipAllocationChart" width="400" height="300"></canvas>
                </div>
            </div>
        </section>

        <section id="sip-projection-long-horizon" class="mb-8">
            <h2 id="sip-projection-long-horizon" class="text-xl font-semibold mb-2">üìà SIP Projection Summary (First 12 Months)</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>Cumulative Contribution</th>
                            <th>Projected Corpus</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>M1</td>
                            <td>251,055.93</td>
                            <td>253,566.49</td>
                        </tr>
                        <tr>
                            <td>M2</td>
                            <td>502,111.86</td>
                            <td>507,658.08</td>
                        </tr>
                        <tr>
                            <td>M3</td>
                            <td>753,167.79</td>
                            <td>761,790.59</td>
                        </tr>
                        <tr>
                            <td>M4</td>
                            <td>1,004,223.72</td>
                            <td>1,015,964.43</td>
                        </tr>
                        <tr>
                            <td>M5</td>
                            <td>1,255,279.65</td>
                            <td>1,270,179.99</td>
                        </tr>
                        <tr>
                            <td>M6</td>
                            <td>1,506,335.58</td>
                            <td>1,524,437.37</td>
                        </tr>
                        <tr>
                            <td>M7</td>
                            <td>1,757,391.51</td>
                            <td>1,778,736.67</td>
                        </tr>
                        <tr>
                            <td>M8</td>
                            <td>2,008,447.44</td>
                            <td>2,033,077.96</td>
                        </tr>
                        <tr>
                            <td>M9</td>
                            <td>2,259,503.37</td>
                            <td>2,287,461.3</td>
                        </tr>
                        <tr>
                            <td>M10</td>
                            <td>2,510,559.3</td>
                            <td>2,541,886.75</td>
                        </tr>
                        <tr>
                            <td>M11</td>
                            <td>2,761,615.23</td>
                            <td>2,796,354.35</td>
                        </tr>
                        <tr>
                            <td>M12</td>
                            <td>3,012,671.16</td>
                            <td>3,050,864.12</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <div class="no-print">
            <button onclick="window.print()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2">Print Report</button>
            <button onclick="downloadReport()" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Download HTML</button>
        </div>

        <script>
            function downloadReport() {
                const htmlContent = document.documentElement.outerHTML;
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'sip_analysis_report.html';
                a.click();
                URL.revokeObjectURL(url);
            }
        </script>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script id="sip-chart-data" type="application/json">{"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91"],"datasets":{"cumulative_contribution":[251055.93,502111.86,753167.79,1004223.72,1255279.65,1506335.58,1757391.51,2008447.44,2259503.37,2510559.3,2761615.23,3012671.16,3263727.09,3514783.02,3765838.95,4016894.88,4267950.81,4519006.74,4770062.67,5021118.6,5272174.53,5523230.46,5774286.39,6025342.32,6276398.25,6527454.18,6778510.11,7029566.04,7280621.97,7531677.9,7782733.83,8033789.76,8284845.69,8535901.62,8786957.55,9038013.48,9289069.41,9540125.34,9791181.27,10042237.2,10293293.13,10544349.06,10795404.99,11046460.92,11297516.85,11548572.78,11799628.71,12050684.64,12301740.57,12552796.5,12803852.43,13054908.36,13305964.29,13557020.22,13808076.15,14059132.08,14310188.01,14561243.94,14812299.87,15063355.8,15314411.73,15565467.66,15816523.59,16067579.52,16318635.45,16569691.38,16820747.31,17071803.24,17322859.17,17573915.1,17824971.03,18076026.96,18327082.89,18578138.82,18829194.75,19080250.68,19331306.61,19582362.54,19833418.47,20084474.4,20335530.33,20586586.26,20837642.19,21088698.12,21339754.05,21590809.98,21841865.91,22092921.84,22343977.77,22595033.7,22846089.63],"projected_corpus":[253566.49,507658.08,761790.59,1015964.43,1270179.99,1524437.37,1778736.67,2033077.96,2287461.3,2541886.75,2796354.35,3050864.12,3305416.1,3559900.39,3814427.03,4068995.96,4323607.25,4578261.95,4832950.12,5087681.85,5342457.22,5597276.35,5852139.24,6107045.96,6361996.55,6616991.06,6872029.52,7127111.95,7382238.39,7637408.86,7892623.38,8147882.0,8403184.75,8658531.63,8913922.62,9169357.84,9424837.35,9680361.15,9935929.29,10191541.71,10447198.45,10702899.57,10958645.09,11214435.09,11470269.57,11726148.59,11982072.19,12238040.34,12494053.07,12750110.43,13006212.46,13262359.11,13518550.45,13774786.49,14031067.29,14287392.89,14543763.35,14799178.64,15055638.85,15312143.97,15568694.04,15825289.07,16081929.09,16338614.01,16595343.88,16852118.75,17108938.59,17365803.44,17622713.24,17879667.97,18136667.68,18393712.35,18650701.95,18907736.49,19164815.98,19421940.42,19679109.82,19936324.15,20193583.42,20450887.67,20708236.88,20965631.02,21223070.16,21480554.29,21738083.36,21995657.42,22253276.42,22510940.32,22768649.15,23026302.97,23284001.73]}},"allocation":{"labels":["Equity","Debt"],"data":[70,30],"meta":{"recommended_fund_categories":{"equity":["Large Cap Funds","Mid Cap Funds","Small Cap Funds"],"debt":["Corporate Bond Funds","Short Duration Funds","Liquid Funds","Government Securities"],"elss_optional":true}}}</script>
    <script>
        function initializeCharts() {
            try {
                // Check if Chart.js is loaded
                if (typeof Chart === 'undefined') {
                    console.error('Chart.js not loaded');
                    return;
                }

                // Get chart data with robust error handling
                let chartData;
                try {
                    const dataScript = document.getElementById('sip-chart-data');
                    if (dataScript && dataScript.textContent.trim()) {
                        chartData = JSON.parse(dataScript.textContent);
                    }
                } catch (e) {
                    console.warn('Failed to parse chart data, using fallbacks:', e);
                }

                // Robust fallback data
                if (!chartData) {
                    chartData = {
                        projection: {
                            labels: ["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"],
                            datasets: {
                                cumulative_contribution: [240372,480745,721117,961490,1201862,1442235,1682607,1922980,2163352,2403725,2644097,2884470],
                                projected_corpus: [242776,485444,730671,978348,1228504,1481162,1736346,1994082,2254395,2517317,2782872,3051094]
                            }
                        },
                        allocation: {
                            labels: ["Equity", "Debt"],
                            data: [70, 30]
                        }
                    };
                }

                // Create projection chart with validation
                const projectionCtx = document.getElementById('sipProjectionChart');
                if (projectionCtx) {
                    new Chart(projectionCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: chartData.projection.labels || [],
                            datasets: [{
                                label: 'Projected Corpus',
                                data: chartData.projection.datasets.projected_corpus || [],
                                borderColor: 'rgb(75, 192, 192)',
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                fill: true,
                                tension: 0.4
                            }, {
                                label: 'Cumulative Contribution',
                                data: chartData.projection.datasets.cumulative_contribution || [],
                                borderColor: 'rgb(255, 99, 132)',
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                fill: false,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: { display: true, text: 'Amount (INR)' },
                                    ticks: {callback: function(value) {return '\u20b9' + (value/100000).toFixed(1) + 'L';}}
                                },
                                x: {
                                    title: { display: true, text: 'Time Period' }
                                }
                            }
                        }
                    });
                }

                // Create allocation chart with validation
                const allocationCtx = document.getElementById('sipAllocationChart');
                if (allocationCtx) {
                    new Chart(allocationCtx.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: chartData.allocation.labels || ['Equity', 'Debt'],
                            datasets: [{
                                data: chartData.allocation.data || [60, 40],
                                backgroundColor: ['#3B82F6', '#10B981'],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: { padding: 20 }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.label + ': ' + context.parsed + '%';
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

            } catch (error) {
                console.error('Chart initialization failed:', error);

                // Show error message in chart containers
                const projectionContainer = document.getElementById('sipProjectionChart');
                const allocationContainer = document.getElementById('sipAllocationChart');
                if (projectionContainer) {
                    projectionContainer.parentElement.innerHTML = '<p>Chart loading failed. Please refresh the page.</p>';
                }
                if (allocationContainer) {
                    allocationContainer.parentElement.innerHTML = '<p>Chart loading failed. Please refresh the page.</p>';
                }
            }
        }

        // Initialize charts when everything is ready with proper timing
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(initializeCharts, 200); // Increased delay to ensure Chart.js is ready
            });
        } else {
            setTimeout(initializeCharts, 200);
        }
    </script>
    
    <script id="goal-input-json" type="application/json">{}</script>
    <script id="inflation-adjusted-json" type="application/json">{}</script>
    <script id="sip-calc-json" type="application/json">{}</script>
    <script id="allocation-plan-json" type="application/json">{}</script>
    <script id="report-payload" type="application/json">{}</script>
</body>
</html>