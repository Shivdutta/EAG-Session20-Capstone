<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comprehensive Retirement SIP Analysis Report</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 20px; background-color: #f9fafb; color: #1f2937; }
    .container { max-width: 1200px; margin: 0 auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    h1 { font-size: 2.25rem; font-weight: bold; color: #111827; border-bottom: 2px solid #3B82F6; padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
    h2 { font-size: 1.5rem; font-weight: bold; color: #111827; margin-top: 2rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid #e5e7eb; }
    table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.9rem; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; vertical-align: top; }
    th { background-color: #f8f9fa; font-weight: 600; }
    p { line-height: 1.6; margin-bottom: 1rem; }
    ul, ol { margin-left: 1.5rem; margin-bottom: 1rem; }
    li { margin-bottom: 0.5rem; }
    b, strong { font-weight: 600; }
    .executive-summary { background-color: #eff6ff; border-left: 4px solid #3B82F6; padding: 1.5rem; margin-bottom: 2rem; border-radius: 4px; }
    .callout { padding: 1.25rem; margin-top: 1.25rem; margin-bottom: 1.25rem; border-left-width: 4px; border-radius: 0.25rem; }
    .callout.warning { background-color: #fffbeb; border-color: #f59e0b; color: #92400e; }
    .callout.warning h4 { font-weight: bold; color: #92400e; margin-bottom: 0.5rem;}
    .no-print { display: block; }

    /* FIXED CHART CONTAINER STYLING - v15 */
    .chart-container h3 { 
      text-align: center; 
      font-size: 1.2rem; 
      font-weight: 600; 
      margin-bottom: 20px; 
      color: #1f2937;
    }

    @media print {
      body { padding: 0; background-color: #fff; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .container { max-width: 100%; box-shadow: none; border: none; padding: 0.5rem; }
      .no-print { display: none; }
      h1, h2 { margin-top: 1.5rem; }
      section, .chart-container { page-break-inside: avoid; }
      table { font-size: 0.8rem; }
      .chart-container { border: 1px solid #ccc !important; }
      canvas { max-height: 250px !important; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Comprehensive Retirement SIP Analysis Report</h1>

    <section id="executive-summary">
      <div class="executive-summary">
        <h2>üéØ Executive Summary</h2>
        <p>This report outlines a detailed Systematic Investment Plan (SIP) designed to achieve a retirement goal. The primary objective is to accumulate a target corpus of <b>‚Çπ1,000,000</b> over a period of <b>10 years</b>. After accounting for an estimated annual inflation rate of <b>5.5%</b>, the future value of this goal is projected to be <b>‚Çπ1,708,144.46</b>. To meet this inflation-adjusted target, a monthly SIP contribution of <b>‚Çπ8,338.71</b> is required, assuming a moderate risk profile with an expected annual return of 10%. The recommended asset allocation is a balanced <b>50% in Equity</b> and <b>50% in Debt</b> instruments. This strategy aims to balance growth potential with capital preservation.</p>
        <div class='callout warning'>‚ö†Ô∏è <strong>Critical Action Required:</strong> The automated fund shortlisting process failed during plan generation. Therefore, this report provides the mathematical framework and allocation strategy but does not contain specific fund recommendations. The plan is currently unactionable and must be re-executed to obtain a valid fund shortlist before any investment is made.</div>
      </div>
    </section>

    <section id='goal-inputs'>
      <h2>üìù Goal Inputs &amp; Parameters</h2>
      <p>The following parameters form the foundation of this investment plan, based on the initial request.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Goal Type</td><td>Retirement</td></tr><tr><td>Current Age</td><td>50</td></tr><tr><td>Retirement Age</td><td>60</td></tr><tr><td>Time Horizon</td><td>10 Years (120 Months)</td></tr><tr><td>Target Amount (Initial)</td><td>‚Çπ1,000,000</td></tr><tr><td>Risk Appetite</td><td>Moderate</td></tr></tbody></table>
    </section>

    <section id='inflation-adjustment'>
      <h2>üìà Inflation Adjustment</h2>
      <p>To preserve purchasing power, the target amount has been adjusted for future inflation.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Assumed Annual Inflation</td><td>5.5%</td></tr><tr><td>Investment Duration</td><td>10 Years</td></tr><tr><td>Unadjusted Target Corpus</td><td>‚Çπ1,000,000.00</td></tr><tr><td><b>Inflation-Adjusted Target Corpus</b></td><td><b>‚Çπ1,708,144.46</b></td></tr></tbody></table>
    </section>

    <section id='sip-calculation'>
      <h2>üßÆ Monthly SIP Calculation</h2>
      <p>This section details the calculation for the required monthly investment to reach the adjusted goal.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Expected Annual Return (Moderate Risk)</td><td>10.0%</td></tr><tr><td>Calculated Monthly Return</td><td>0.8333%</td></tr><tr><td>Investment Period (Months)</td><td>120</td></tr><tr><td><b>Required Monthly SIP</b></td><td><b>‚Çπ8,338.71</b></td></tr></tbody></table>
    </section>

    <section id='asset-allocation'>
      <h2>‚öñÔ∏è Asset Allocation Plan</h2>
      <p>Based on a 'Moderate' risk profile, a balanced allocation between equity and debt is recommended to optimize for growth while managing risk.</p>
      <table><thead><tr><th>Asset Class</th><th>Allocation %</th><th>Recommended Fund Categories</th></tr></thead><tbody><tr><td>Equity</td><td>50%</td><td><ul><li>Large Cap Funds</li><li>Mid Cap Funds</li></ul></td></tr><tr><td>Debt</td><td>50%</td><td><ul><li>Corporate Bond Funds</li><li>Government Securities</li></ul></td></tr></tbody></table>
      <p><em>An ELSS (Equity Linked Savings Scheme) can be considered for tax-saving purposes within the equity portion.</em></p>
    </section>

    <section id='allocation-notes'>
      <h2>‚ÑπÔ∏è Allocation Risk Profile Notes</h2>
      <p>The following guidelines define the relationship between risk appetite and asset allocation strategy.</p>
      <ul><li><b>Very Low:</b> Extremely conservative, e.g., 90% debt / 10% equity</li><li><b>Low:</b> Conservative, e.g., 70% debt / 30% equity</li><li><b>Low-Moderate:</b> Tilted conservative, e.g., 60% debt / 40% equity</li><li><b>Moderate:</b> Balanced mix, e.g., 50% equity / 50% debt</li><li><b>High-Moderate:</b> Tilted aggressive, e.g., 60% equity / 40% debt</li><li><b>High:</b> Aggressive, e.g., 70% equity / 30% debt</li><li><b>Very High:</b> Extremely aggressive, e.g., 90% equity / 10% debt</li></ul>
    </section>

    <section id='key-recommendations'>
      <h2>üîë Key Recommendations</h2>
      <div class='callout warning'><h4>Action Blocked: Fund Selection Failure</h4><p>The most critical recommendation is to address the data failure that prevented the generation of a fund shortlist. Without a concrete list of investment vehicles, this financial plan remains theoretical. <b>Do not proceed with any investment based on this document.</b> The workflow must be re-run to successfully retrieve and reconcile fund options.</p></div>
      <p>Once the fund selection issue is resolved, the following strategic actions are recommended:</p>
      <ol><li><b>Implement the SIP:</b> Begin the monthly investment of <b>‚Çπ8,338.71</b> into the selected funds as per the 50/50 allocation.</li><li><b>Diversify Within Categories:</b> Within the equity and debt portions, consider diversifying across 2-3 funds in the recommended categories to mitigate fund-specific risk.</li><li><b>Annual Review & Rebalancing:</b> Review the portfolio's performance and asset allocation at least once a year. If market movements cause the allocation to drift significantly from the 50/50 target (e.g., to 60/40), rebalance the portfolio.</li><li><b>Stay Disciplined:</b> The success of a SIP is heavily dependent on consistency. Avoid pausing contributions, especially during market downturns, as these periods allow for purchasing more units at a lower cost (rupee cost averaging).</li></ol>
    </section>

    <section id='risk-factors'>
      <h2>üìâ Risk Factors and Uncertainties</h2>
      <p>Investing in mutual funds via SIPs involves inherent risks that must be understood. While this plan aligns with a moderate risk profile, it is not immune to market dynamics. The primary risks include <b>Market Risk</b>, where equity values can fluctuate due to economic, political, and global factors. A downturn could lead to negative returns. Secondly, <b>Inflation Risk</b> poses a persistent threat; if inflation exceeds the projected 5.5%, the real value of the final corpus will be lower than anticipated. <b>Interest Rate Risk</b> primarily affects the debt portion. A rise in interest rates can cause the value of existing bonds to fall. Furthermore, there is a significant <b>Execution Risk</b> associated with this specific plan due to the failure in the fund selection process. Investing without a properly vetted shortlist of funds introduces unacceptable risk and is strongly discouraged. Regular monitoring and periodic re-evaluation are crucial to navigate these uncertainties.</p>
    </section>

    <!-- v15 FIXED CHART LAYOUT IMPLEMENTATION -->
    <section id="sip-charts">
      <h2>üìä SIP Projection & Allocation Charts</h2>
      <div style="display: block; max-width: 1000px; margin: 0 auto;">
        <!-- Asset Allocation FIRST (TOP) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
          <h3 style="margin-bottom: 15px;">Asset Allocation</h3>
          <div style="max-width: 500px; margin: 0 auto;">
            <canvas id="sipAllocationChart" width="400" height="300" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
        
        <!-- SIP Growth Projection SECOND (BOTTOM) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
          <h3 style="margin-bottom: 15px;">SIP Growth Projection</h3>
          <div style="max-width: 800px; margin: 0 auto;">
            <canvas id="sipProjectionChart" width="600" height="400" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
      </div>
    </section>

    <section id="monthly-projection">
      <h2>üóìÔ∏è Monthly Projection (First 12 Months)</h2>
      <div class="table-container">
        <table><thead><tr><th>Month</th><th>Cumulative Contribution</th><th>Projected Corpus</th></tr></thead><tbody><tr><td>M1</td><td>‚Çπ8,338.71</td><td>‚Çπ8,338.71</td></tr><tr><td>M2</td><td>‚Çπ16,677.42</td><td>‚Çπ16,746.91</td></tr><tr><td>M3</td><td>‚Çπ25,016.13</td><td>‚Çπ25,225.18</td></tr><tr><td>M4</td><td>‚Çπ33,354.84</td><td>‚Çπ33,774.05</td></tr><tr><td>M5</td><td>‚Çπ41,693.55</td><td>‚Çπ42,394.06</td></tr><tr><td>M6</td><td>‚Çπ50,032.26</td><td>‚Çπ51,085.74</td></tr><tr><td>M7</td><td>‚Çπ58,370.97</td><td>‚Çπ59,849.63</td></tr><tr><td>M8</td><td>‚Çπ66,709.68</td><td>‚Çπ68,686.29</td></tr><tr><td>M9</td><td>‚Çπ75,048.39</td><td>‚Çπ77,596.28</td></tr><tr><td>M10</td><td>‚Çπ83,387.10</td><td>‚Çπ86,580.14</td></tr><tr><td>M11</td><td>‚Çπ91,725.81</td><td>‚Çπ95,638.45</td></tr><tr><td>M12</td><td>‚Çπ100,064.52</td><td>‚Çπ104,771.76</td></tr></tbody></table>
      </div>
      <p><em>Note: Complete projection timeline (120 months) is visualized in the chart above.</em></p>
    </section>

    <section id='image-debug'>
        <h2>üñºÔ∏è Image Integration Debug Log</h2>
        <p>As per the mandatory image integration protocol, I have scanned all available input data sources. No data structures containing image URLs were found. Therefore, no images have been included in this report.</p>
    </section>

    <div style="margin: 20px 0; text-align: center;" class="no-print">
      <button onclick="window.print()" style="margin: 5px; padding: 12px 24px; background-color: #3B82F6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Print Report</button>
      <button onclick="downloadHTML()" style="margin: 5px; padding: 12px 24px; background-color: #10B981; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Download HTML</button>
    </div>

  </div>

  <script id="chart-data" type="application/json">
  {"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91","M92","M93","M94","M95","M96","M97","M98","M99","M100","M101","M102","M103","M104","M105","M106","M107","M108","M109","M110","M111","M112","M113","M114","M115","M116","M117","M118","M119","M120"],"datasets":{"cumulative_contribution":[8338.71,16677.42,25016.13,33354.84,41693.55,50032.26,58370.97,66709.68,75048.39,83387.1,91725.81,100064.52,108403.23,116741.94,125080.65,133419.36,141758.07,150096.78,158435.49,166774.2,175112.91,183451.62,191790.33,200129.04,208467.75,216806.46,225145.17,233483.88,241822.59,250161.3,258500.01,266838.72,275177.43,283516.14,291854.85,300193.56,308532.27,316870.98,325209.69,333548.4,341887.11,350225.82,358564.53,366903.24,375241.95,383580.66,391919.37,400258.08,408596.79,416935.5,425274.21,433612.92,441951.63,450290.34,458629.05,466967.76,475306.47,483645.18,491983.89,500322.6,508661.31,517000.02,525338.73,533677.44,542016.15,550354.86,558693.57,567032.28,575370.99,583709.7,592048.41,600387.12,608725.83,617064.54,625403.25,633741.96,642080.67,650419.38,658758.09,667096.8,675435.51,683774.22,692112.93,700451.64,708790.35,717129.06,725467.77,733806.48,742145.19,750483.9,758822.61,767161.32,775500.03,783838.74,792177.45,800516.16,808854.87,817193.58,825532.29,833871.0,842209.71,850548.42,858887.13,867225.84,875564.55,883903.26,892241.97,900580.68,908919.39,917258.1,925596.81,933935.52,942274.23,950612.94,958951.65,967290.36,975629.07,983967.78,992306.49,1000645.2],"projected_corpus":[8338.71,16746.91,25225.18,33774.05,42394.06,51085.74,59849.63,68686.29,77596.28,86580.14,95638.45,104771.76,113980.65,123265.68,132627.42,142066.45,151583.35,161178.69,170853.05,180607.01,190441.16,200356.1,210352.42,220430.71,230591.56,240835.59,251163.41,261575.64,272072.9,282655.82,293325.02,304081.14,314924.81,325856.67,336877.34,347987.48,359187.72,370478.71,381861.11,393335.57,404902.75,416563.31,428317.91,440167.22,452111.9,464152.63,476290.08,488524.94,500857.88,513289.59,525820.76,538452.09,551184.28,564018.03,576954.04,589993.02,603135.68,616382.74,629734.92,643193.05,656757.85,670430.07,684210.46,698099.78,712098.78,726208.23,740428.93,754761.64,769207.15,783766.23,798439.65,813228.18,828132.58,843153.67,858292.25,873549.12,888925.09,904420.97,920037.61,935775.86,951636.56,967620.57,983728.74,999961.94,1016321.02,1032806.86,1049420.35,1066162.35,1083033.72,1100035.34,1117168.1,1134432.84,1151830.45,1169361.8,1187027.78,1204829.31,1222767.29,1240842.62,1259056.17,1277408.84,1295901.55,1314535.2,1333310.69,1352228.95,1371290.86,1390497.3,1409849.15,1429347.26,1448992.52,1468785.8,1488727.98,1508819.95,1529062.61,1549456.83,1570003.5,1590703.5,1611557.7,1632567.01,1653732.34,1675054.61]}},"allocation":{"labels":["Equity","Debt"],"data":[50,50],"meta":{"recommended_fund_categories":{"equity":["Large Cap Funds","Mid Cap Funds"],"debt":["Corporate Bond Funds","Government Securities"],"elss_optional":true}}}}
  </script>

  <script>
    function downloadHTML() {
      const html = document.documentElement.outerHTML;
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'comprehensive_report.html';
      a.click();
      URL.revokeObjectURL(url);
    }

    function initCharts() {
      if (typeof Chart === 'undefined') {
        console.error('Chart.js not loaded');
        return;
      }
      
      let data;
      try {
        const script = document.getElementById('chart-data');
        data = script ? JSON.parse(script.textContent) : null;
      } catch (e) {
        console.warn('Chart data parse failed');
        data = null;
      }
      
      if (!data || !data.projection || !data.allocation) {
        console.warn('Using fallback data because provided data is incomplete.');
        data = {
          projection: {
            labels: ["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"],
            datasets: {
              cumulative_contribution: [8338,16677,25016,33354,41693,50032,58370,66709,75048,83387,91725,100064],
              projected_corpus: [8338,16746,25225,33774,42394,51085,59849,68686,77596,86580,95638,104771]
            }
          },
          allocation: { labels: ["Equity", "Debt"], data: [50, 50] }
        };
      }
      
      // Create allocation chart FIRST (TOP POSITION)
      const allocCtx = document.getElementById('sipAllocationChart');
      if (allocCtx) {
        new Chart(allocCtx, {
          type: 'doughnut',
          data: {
            labels: data.allocation.labels,
            datasets: [{ 
              data: data.allocation.data, 
              backgroundColor: ['#3B82F6', '#10B981'],
              borderWidth: 2 
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.33,
            plugins: {
              legend: { 
                position: 'bottom',
                labels: { padding: 15 }
              }
            }
          }
        });
      }
      
      // Create projection chart SECOND (BOTTOM POSITION)
      const projCtx = document.getElementById('sipProjectionChart');
      if (projCtx) {
        new Chart(projCtx, {
          type: 'line',
          data: {
            labels: data.projection.labels,
            datasets: [{
              label: 'Projected Corpus',
              data: data.projection.datasets.projected_corpus,
              borderColor: '#3B82F6',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              fill: true,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }, {
              label: 'Cumulative Contribution', 
              data: data.projection.datasets.cumulative_contribution,
              borderColor: '#EF4444',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              fill: false,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.5,
            interaction: {
              mode: 'nearest',
              intersect: false
            },
            scales: {
              x: {
                title: { display: true, text: 'Time Period (Months)' },
                ticks: { maxTicksLimit: 12 }
              },
              y: {
                beginAtZero: true,
                title: { display: true, text: 'Amount (INR)' },
                ticks: {
                  callback: function(value) {
                    if (value >= 10000000) return '‚Çπ' + (value/10000000).toFixed(2) + 'Cr';
                    if (value >= 100000) return '‚Çπ' + (value/100000).toFixed(1) + 'L';
                    return '‚Çπ' + (value/1000).toFixed(0) + 'K';
                  }
                }
              }
            },
            plugins: {
              tooltip: {
                mode: 'index',
                intersect: false
              }
            }
          }
        });
      }
    }

    setTimeout(initCharts, 500);
  </script>

</body>
</html>