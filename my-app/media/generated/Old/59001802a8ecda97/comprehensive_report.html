<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comprehensive Investment Report: Retirement Goal</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 20px; background-color: #f9fafb; color: #1f2937; }
    .container { max-width: 1200px; margin: 0 auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    h1 { font-size: 2.25rem; font-weight: bold; color: #111827; border-bottom: 2px solid #3B82F6; padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
    h2 { font-size: 1.5rem; font-weight: bold; color: #111827; margin-top: 2rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid #e5e7eb; }
    h3 { font-size: 1.1rem; font-weight: 600; color: #1f2937; }
    table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
    th { background-color: #f8f9fa; font-weight: 600; }
    p { line-height: 1.6; margin-bottom: 1rem; }
    ul, ol { margin-left: 1.5rem; margin-bottom: 1rem; }
    li { margin-bottom: 0.5rem; }
    .executive-summary { background-color: #eff6ff; border-left: 4px solid #3B82F6; padding: 1.5rem; margin: 2rem 0; border-radius: 4px; }
    .warning-callout { background-color: #fffbeb; border-left: 4px solid #f59e0b; padding: 1.5rem; margin-top: 1rem; border-radius: 4px; }
    .no-print { display: block; }
    @media print {
      .no-print { display: none; }
      body { padding: 0; background-color: #fff; }
      .container { box-shadow: none; border: none; padding: 0.5rem; }
      h1, h2 { margin-top: 1.5rem; }
      .chart-container { page-break-inside: avoid !important; margin: 15px 0; }
      canvas { max-height: 250px !important; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìã Comprehensive SIP Financial Plan: Retirement Goal</h1>
    
    <div style="margin: 20px 0; text-align: center;" class="no-print">
      <button onclick="window.print()" style="margin: 5px; padding: 12px 24px; background-color: #3B82F6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Print Report</button>
      <button onclick="downloadHTML()" style="margin: 5px; padding: 12px 24px; background-color: #10B981; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Download HTML</button>
    </div>

    <section id="executive-summary">
      <div class="executive-summary">
        <h2>üéØ Executive Summary</h2>
        <p>This report outlines a strategic Systematic Investment Plan (SIP) designed to achieve a retirement corpus of <b>‚Çπ10,000,000</b> in today's value. Factoring in a <b>5.5%</b> annual inflation rate over a <b>10-year</b> horizon, the future target corpus is <b>‚Çπ1,70,81,445</b>. To reach this goal with a 'low_moderate' risk profile and an assumed annual return of <b>8%</b>, a monthly SIP contribution of <b>‚Çπ93,369</b> is required. The recommended asset allocation is a portfolio of <b>40% in Equity</b> and <b>60% in Debt</b>.</p>
        <div class="warning-callout">
          <p>‚ö†Ô∏è <strong>Process Alert:</strong> While the strategic calculations are complete, the subsequent step to shortlist specific fund categories failed due to an upstream data retrieval error. Therefore, the plan is currently blocked, and no investments should be made until the fund selection process is successfully executed. The immediate next step is to diagnose and resolve this data issue.</p>
        </div>
      </div>
    </section>

    <section id="goal-inputs">
      <h2>Goal Inputs & Investor Profile</h2>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Financial Goal</td><td>Retirement</td></tr><tr><td>Current Age</td><td>50 Years</td></tr><tr><td>Target Retirement Age</td><td>60 Years</td></tr><tr><td>Investment Horizon</td><td>10 Years (120 Months)</td></tr><tr><td>Target Amount (Current Value)</td><td>‚Çπ10,000,000</td></tr><tr><td>Risk Appetite</td><td>Low-Moderate</td></tr></tbody></table>
    </section>

    <section id="inflation-adjustment">
      <h2>Inflation Adjustment Analysis</h2>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Assumed Annual Inflation</td><td>5.5%</td></tr><tr><td>Investment Period</td><td>10 Years</td></tr><tr><td>Unadjusted Target Corpus</td><td>‚Çπ10,000,000.00</td></tr><tr><td><b>Inflation-Adjusted Target Corpus</b></td><td><b>‚Çπ17,081,444.57</b></td></tr></tbody></table>
    </section>

    <section id="sip-calculation">
      <h2>SIP Calculation Breakdown</h2>
       <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Inflation-Adjusted Target</td><td>‚Çπ17,081,444.57</td></tr><tr><td>Total Investment Months</td><td>120</td></tr><tr><td>Assumed Annual Return (for 'low_moderate' risk)</td><td>8.00%</td></tr><tr><td><b>Required Monthly SIP Investment</b></td><td><b>‚Çπ93,368.54</b></td></tr></tbody></table>
    </section>

    <section id="asset-allocation">
      <h2>Strategic Asset Allocation Plan</h2>
      <table><thead><tr><th>Asset Class</th><th>Allocation</th><th>Recommended Fund Categories</th></tr></thead><tbody><tr><td>Equity</td><td>40%</td><td>Large Cap Funds, Mid Cap Funds</td></tr><tr><td>Debt</td><td>60%</td><td>Corporate Bond Funds, Government Securities</td></tr><tr><td>Tax Saver (Optional)</td><td>N/A</td><td>ELSS can be considered as part of the equity portion for tax benefits.</td></tr></tbody></table>
    </section>

    <section id="key-recommendations">
      <h2>Key Recommendations & Next Steps</h2>
      <ol>
        <li><b>Halt Execution:</b> Do not initiate any investments based on this plan yet. The failure in the fund selection stage is a critical blocker that must be resolved first.</li>
        <li><b>Troubleshoot Upstream Data:</b> The primary action is to investigate and rectify the error in the data retrieval process that prevented the generation of a fund shortlist.</li>
        <li><b>Re-run Process:</b> Once the underlying data issue is fixed, the fund selection and reconciliation steps must be re-executed to generate a valid list of fund categories.</li>
        <li><b>Initiate SIP Post-Resolution:</b> After a valid fund portfolio is constructed, proceed with initiating a monthly SIP of <b>‚Çπ93,369</b>, distributing the amount across the selected funds.</li>
        <li><b>Annual Review:</b> Commit to an annual review of the portfolio to assess performance, rebalance the allocation if it has drifted, and consider increasing the SIP amount.</li>
      </ol>
    </section>

    <section id="risk-factors">
      <h2>Risk Factors & Uncertainties</h2>
      <p>This investment plan is subject to various risks. While designed for a 'low_moderate' risk profile, no investment is without risk, and outcomes are not guaranteed. The projected corpus is based on assumptions that may not hold true.</p>
      <ul>
        <li><b>Market Risk:</b> The assumed 8% annual return is a long-term average, not a certainty. Markets can be volatile, and economic downturns, geopolitical events, or changes in interest rates could lead to periods of negative returns.</li>
        <li><b>Inflation Risk:</b> The plan assumes a 5.5% average annual inflation rate. If actual inflation is persistently higher, the real value of the final corpus will be eroded, requiring a higher SIP or a longer horizon to compensate.</li>
        <li><b>Process & Operational Risk:</b> As highlighted, the overall process is exposed to operational failures. The inability to generate a fund shortlist has currently halted progress, underscoring the dependency on data integrity and process automation.</li>
        <li><b>Discipline & Execution Risk:</b> The success of this plan is critically dependent on the investor's discipline in making consistent monthly contributions for the full 120-month period without interruption. Pausing or stopping contributions will jeopardize the ability to reach the target.</li>
      </ul>
    </section>

    <!-- v15 FIXED CHART SECTION - VERTICAL STACK WITH PROPER CENTERING -->
    <section id="sip-charts">
      <h2>üìä SIP Projection & Allocation Charts</h2>
      <div style="display: block; max-width: 1000px; margin: 0 auto;">
        <!-- Asset Allocation FIRST (TOP) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
          <h3 style="margin-bottom: 15px;">Asset Allocation</h3>
          <div style="max-width: 500px; margin: 0 auto;">
            <canvas id="sipAllocationChart" width="400" height="300" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
        
        <!-- SIP Growth Projection SECOND (BOTTOM) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
          <h3 style="margin-bottom: 15px;">SIP Growth Projection (10-Year Horizon)</h3>
          <div style="max-width: 800px; margin: 0 auto;">
            <canvas id="sipProjectionChart" width="600" height="400" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
      </div>
    </section>

    <section id="monthly-projection">
      <h2>üìà Monthly Projection (First 12 Months)</h2>
      <table>
        <thead><tr><th>Month</th><th>Cumulative Contribution</th><th>Projected Corpus Value</th></tr></thead>
        <tbody><tr><td>M1</td><td>‚Çπ93,368.54</td><td>‚Çπ93,368.54</td></tr><tr><td>M2</td><td>‚Çπ1,86,737.08</td><td>‚Çπ1,87,359.53</td></tr><tr><td>M3</td><td>‚Çπ2,80,105.62</td><td>‚Çπ2,81,977.13</td></tr><tr><td>M4</td><td>‚Çπ3,73,474.16</td><td>‚Çπ3,77,225.50</td></tr><tr><td>M5</td><td>‚Çπ4,66,842.70</td><td>‚Çπ4,73,108.84</td></tr><tr><td>M6</td><td>‚Çπ5,60,211.24</td><td>‚Çπ5,69,631.39</td></tr><tr><td>M7</td><td>‚Çπ6,53,579.78</td><td>‚Çπ6,66,797.43</td></tr><tr><td>M8</td><td>‚Çπ7,46,948.32</td><td>‚Çπ7,64,611.28</td></tr><tr><td>M9</td><td>‚Çπ8,40,316.86</td><td>‚Çπ8,63,077.25</td></tr><tr><td>M10</td><td>‚Çπ9,33,685.40</td><td>‚Çπ9,62,199.70</td></tr><tr><td>M11</td><td>‚Çπ10,27,053.94</td><td>‚Çπ10,61,982.99</td></tr><tr><td>M12</td><td>‚Çπ11,20,422.48</td><td>‚Çπ11,62,431.54</td></tr></tbody>
      </table>
    </section>
    
    <section id="debug-info" style="margin-top: 2rem; padding: 1rem; background: #f3f4f6; border-radius: 8px;">
        <h3>Debug Information</h3>
        <p>No image objects were found in the provided data sources. Therefore, no images have been embedded in this report.</p>
    </section>

  </div>

  <!-- EMBEDDED DATA AND SCRIPTS -->
  <script id="chart-data" type="application/json">{"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91","M92","M93","M94","M95","M96","M97","M98","M99","M100","M101","M102","M103","M104","M105","M106","M107","M108","M109","M110","M111","M112","M113","M114","M115","M116","M117","M118","M119","M120"],"datasets":{"cumulative_contribution":[93368.54,186737.08,280105.62,373474.16,466842.7,560211.24,653579.78,746948.32,840316.86,933685.4,1027053.94,1120422.48,1213791.02,1307159.56,1400528.1,1493896.64,1587265.18,1680633.72,1774002.26,1867370.8,1960739.34,2054107.88,2147476.42,2240844.96,2334213.5,2427582.04,2520950.58,2614319.12,2707687.66,2801056.2,2894424.74,2987793.28,3081161.82,3174530.36,3267898.9,3361267.44,3454635.98,3548004.52,3641373.06,3734741.6,3828110.14,3921478.68,4014847.22,4108215.76,4201584.3,4294952.84,4388321.38,4481689.92,4575058.46,4668427.0,4761795.54,4855164.08,4948532.62,5041901.16,5135269.7,5228638.24,5322006.78,5415375.32,5508743.86,5602112.4,5695480.94,5788849.48,5882218.02,5975586.56,6068955.1,6162323.64,6255692.18,6349060.72,6442429.26,6535797.8,6629166.34,6722534.88,6815903.42,6909271.96,7002640.5,7096009.04,7189377.58,7282746.12,7376114.66,7469483.2,7562851.74,7656220.28,7749588.82,7842957.36,7936325.9,8029694.44,8123062.98,8216431.52,8309800.06,8403168.6,8496537.14,8589905.68,8683274.22,8776642.76,8870011.3,8963379.84,9056748.38,9150116.92,9243485.46,9336854.0,9430222.54,9523591.08,9616959.62,9710328.16,9803696.7,9897065.24,9990433.78,10083802.32,10177170.86,10270539.4,10363907.94,10457276.48,10550645.02,10644013.56,10737382.1,10830750.64,10924119.18,11017487.72,11110856.26,11204224.8],"projected_corpus":[93368.54,187359.53,281977.13,377225.5,473108.84,569631.39,666797.43,764611.28,863077.25,962199.7,1061982.99,1162431.54,1263550.0,1365342.97,1467815.11,1570971.07,1674815.54,1779353.25,1884588.94,1990527.38,2097173.36,2204531.72,2312607.3,2421404.98,2530929.68,2641186.41,2752180.22,2863916.22,2976399.58,3089635.51,3203629.28,3318386.17,3433911.51,3550210.66,3667289.0,3785151.93,3903804.94,4023253.51,4143503.2,4264559.55,4386428.15,4509114.64,4632624.7,4756963.99,4882138.25,5008153.21,5135014.59,5262728.16,5391299.71,5520735.04,5651039.97,5782220.34,5914282.01,6047230.89,6181072.93,6315814.08,6451450.24,6587987.31,6725431.23,6863787.94,7003063.36,7143263.45,7284394.2,7426461.59,7569471.67,7713430.48,7858344.15,8004218.81,8151060.6,8298875.71,8447670.35,8597450.78,8748223.32,8899994.31,9052770.14,9206557.24,9361362.06,9517191.14,9674051.05,9831948.39,9990889.74,10150881.71,10311930.92,10474044.02,10637227.68,10801488.53,10966833.22,11133268.44,11300801.0,11469437.67,11639185.32,11810050.89,11982041.26,12155163.37,12329424.16,12504830.65,12681389.85,12859108.79,13037994.48,13218054.11,13399295.14,13581725.14,13765351.64,13950182.22,14136224.44,14323485.94,14511974.34,14701697.34,14892662.65,15084878.07,15278351.42,15473090.53,15669103.26,15866397.58,16064981.43,16264862.8,16466049.72,16668550.21,16872372.21,17077523.69]}},"allocation":{"labels":["Equity","Debt"],"data":[40,60]}}</script>
  
  <script>
    function downloadHTML() {
      const html = document.documentElement.outerHTML;
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'comprehensive_sip_report.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function initCharts() {
      if (typeof Chart === 'undefined') {
        console.error('Chart.js not loaded');
        return;
      }
      
      let data;
      try {
        const script = document.getElementById('chart-data');
        data = script ? JSON.parse(script.textContent) : null;
      } catch (e) {
        console.warn('Chart data parse failed');
        data = null;
      }
      
      if (!data) {
        console.warn('Fallback data is being used for charts.');
        data = {
          projection: {
            labels: Array.from({length: 120}, (_, i) => `M${i + 1}`),
            datasets: { cumulative_contribution: [], projected_corpus: [] }
          },
          allocation: { labels: ["Equity", "Debt"], data: [40, 60] }
        };
      }
      
      const allocCtx = document.getElementById('sipAllocationChart');
      if (allocCtx) {
        new Chart(allocCtx, {
          type: 'doughnut',
          data: {
            labels: data.allocation.labels,
            datasets: [{ 
              data: data.allocation.data, 
              backgroundColor: ['#3B82F6', '#10B981'],
              borderWidth: 2 
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.33,
            plugins: {
              legend: { position: 'bottom', labels: { padding: 15 } }
            }
          }
        });
      }
      
      const projCtx = document.getElementById('sipProjectionChart');
      if (projCtx) {
        new Chart(projCtx, {
          type: 'line',
          data: {
            labels: data.projection.labels,
            datasets: [{
              label: 'Projected Corpus',
              data: data.projection.datasets.projected_corpus,
              borderColor: '#3B82F6',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              fill: true,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }, {
              label: 'Cumulative Contribution', 
              data: data.projection.datasets.cumulative_contribution,
              borderColor: '#EF4444',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              fill: false,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.5,
            interaction: { mode: 'nearest', intersect: false },
            scales: {
              x: { title: { display: true, text: 'Time Period (Months)' }, ticks: { maxTicksLimit: 12 } },
              y: { beginAtZero: true, title: { display: true, text: 'Amount (INR)' }, ticks: { callback: function(value) { return '‚Çπ' + (value/100000).toFixed(1) + 'L'; } } }
            },
            plugins: { tooltip: { mode: 'index', intersect: false } }
          }
        });
      }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() { setTimeout(initCharts, 500); });
    } else {
        setTimeout(initCharts, 500);
    }
  </script>

</body>
</html>