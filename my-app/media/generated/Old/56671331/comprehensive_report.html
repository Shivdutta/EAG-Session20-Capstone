<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Systematic Investment Plan (SIP) Analysis Report</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; margin: 0; padding: 20px; color: #1f2937; }
    .container { max-width: 1000px; margin: 0 auto; background-color: #fff; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    h1, h2, h3 { color: #111827; font-weight: 600; margin-top: 1.5em; margin-bottom: 0.5em; }
    h1 { font-size: 2.25rem; text-align: center; margin-top: 0; color: #3b82f6; }
    h2 { font-size: 1.5rem; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.5rem; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
    th { background-color: #f9fafb; font-weight: 600; }
    td:first-child { font-weight: 500; }
    .summary-card { background-color: #f9fafb; border: 1px solid #e5e7eb; border-left: 5px solid #3b82f6; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
    .recommendation { margin-bottom: 1rem; padding-left: 1.5rem; position: relative; }
    .recommendation::before { content: '‚úì'; position: absolute; left: 0; color: #10b981; font-weight: bold; }
    .risk-warning { border-left-color: #ef4444; }
    .print-controls { text-align: center; margin-top: 2rem; padding: 1rem; background-color: #f9fafb; border-radius: 8px; }
    button { background-color: #3b82f6; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 1rem; margin: 5px; transition: background-color 0.3s; }
    button:hover { background-color: #2563eb; }
    @media print {
      .print-controls { display: none; }
      body { padding: 0; }
      .container { box-shadow: none; border: none; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 1. Title -->
    <header>
      <h1>Systematic Investment Plan (SIP) Analysis Report</h1>
      <p style="text-align: center; color: #6b7280;">Prepared for: House Purchase Goal</p>
    </header>

    <!-- 2. Executive Summary -->
    <section id="executive-summary" class="summary-card">
      <h2>üéØ Executive Summary</h2>
      <p>This Systematic Investment Plan (SIP) is designed to help you achieve your goal of a 'House Purchase' by accumulating a target corpus of approximately INR 1.31 Crore over the next 5 years, accounting for a 5.5% annual inflation rate on your initial goal of INR 1 Crore. To reach this target, a monthly investment of INR 168,767 is required, based on a projected annual return of 10%. The strategy employs a balanced asset allocation of 50% in equity and 50% in debt, consistent with a 'moderate' risk profile. While the plan identifies suitable fund categories for the equity portion (Large & Mid Cap Funds), a critical finding requires your immediate attention: there is a significant mismatch between the recommended low-risk debt fund categories ('Corporate Bond', 'Short Duration') and the higher-risk category ('Credit Risk') of the available shortlisted funds. This report provides clear recommendations to address this discrepancy to ensure your portfolio remains aligned with your stated risk tolerance.</p>
    </section>

    <!-- 3. Goal Inputs -->
    <section id="goal-inputs">
      <h2>üìù Goal Inputs</h2>
      <table>
        <tbody>
          <tr><td>Goal</td><td>House Purchase</td></tr>
          <tr><td>Initial Target Amount</td><td>‚Çπ1,00,00,000</td></tr>
          <tr><td>Time Horizon</td><td>5 Years (60 Months)</td></tr>
          <tr><td>Risk Appetite</td><td style="text-transform: capitalize;">moderate</td></tr>
        </tbody>
      </table>
    </section>

    <!-- 4. Inflation Adjustment -->
    <section id="inflation-adjustment">
      <h2>üí® Inflation Adjustment</h2>
      <table>
        <tbody>
          <tr><td>Assumed Annual Inflation</td><td>5.5%</td></tr>
          <tr><td>Future Value of Target (Adjusted for Inflation)</td><td>‚Çπ1,30,69,601</td></tr>
        </tbody>
      </table>
    </section>

    <!-- 5. SIP Calculation -->
    <section id="sip-calculation">
      <h2>üßÆ SIP Calculation</h2>
      <table>
        <tbody>
          <tr><td>Projected Annual Return</td><td>10%</td></tr>
          <tr><td>Required Monthly SIP</td><td><strong>‚Çπ1,68,767</strong></td></tr>
        </tbody>
      </table>
    </section>

    <!-- 6. Asset Allocation Plan -->
    <section id="asset-allocation">
      <h2>üß≠ Asset Allocation Plan</h2>
      <p>The plan is based on a balanced 50% Equity / 50% Debt allocation to align with a 'moderate' risk profile. The following table details the recommended funds, including a critical warning regarding the debt fund category.</p>
      <table>
        <thead>
          <tr><th>Asset Class</th><th>Fund Name</th><th>Category</th><th>Allocation %</th><th>Monthly Amount (INR)</th><th>Rationale & Notes</th></tr>
        </thead>
        <tbody>
          <tr><td>Equity</td><td>Motilal Oswal Large and Midcap Fund</td><td>Equity - Large & Mid Cap</td><td>20%</td><td>33,753.43</td><td>Good alignment with Large & Mid Cap strategy. T012 noted strong performance metrics.</td></tr>
          <tr><td>Equity</td><td>Invesco India Large & Mid Cap Fund</td><td>Equity - Large & Mid Cap</td><td>15%</td><td>25,315.07</td><td>Provides diversification within the equity allocation. Strong reported returns.</td></tr>
          <tr><td>Equity</td><td>Bandhan Large & Mid Cap Fund</td><td>Equity - Large & Mid Cap</td><td>15%</td><td>25,315.07</td><td>Further diversifies the equity holdings.</td></tr>
          <tr style="background-color: #fee2e2;"><td>Debt</td><td>Aditya Birla Sun Life Credit Risk Fund</td><td>Debt - Credit Risk</td><td>50%</td><td>84,383.57</td><td><strong>WARNING:</strong> Category mismatch. This fund has a higher risk profile than the recommended 'Corporate Bond' or 'Short Duration' funds. See Risks section.</td></tr>
        </tbody>
      </table>
    </section>

    <!-- 7. Key Recommendations -->
    <section id="key-recommendations">
      <h2>üîë Key Recommendations</h2>
      <div class="recommendation"><strong>(High Priority) Implement the Equity Plan:</strong> Begin investing 50% of your monthly SIP (approximately INR 84,384) into a diversified mix of 'Large & Mid Cap' equity mutual funds to target long-term growth.</div>
      <div class="recommendation"><strong>(Critical Priority) Take Corrective Action on Debt Allocation:</strong> Do not proceed with a debt fund from the 'Credit Risk' category without full consideration. You must actively search for and select funds within the originally recommended 'Corporate Bond' or 'Short Duration' categories to keep your portfolio aligned with a 'moderate' risk profile.</div>
      <div class="recommendation"><strong>(High Priority) Maintain Investment Discipline:</strong> Consistency is key to the success of any SIP. Ensure you invest the recommended amount regularly every month for the full 5-year term to leverage the benefits of compounding and rupee cost averaging.</div>
      <div class="recommendation"><strong>(Medium Priority) Verify All Fund Information:</strong> Before making any investment, independently verify all fund details such as historical performance, expense ratios, and fund manager history using official sources.</div>
    </section>

    <!-- 8. Risk Factors & Uncertainties -->
    <section id="risk-factors">
        <h2>‚ö†Ô∏è Risk Factors & Uncertainties</h2>
        <p>All investments are subject to risk, and it is essential to understand the factors that could impact your financial goal. This plan is based on assumptions that may differ from future reality.</p>
        <div class="summary-card risk-warning">
            <h3>Credit Risk in Debt Allocation (Specific & High-Impact)</h3>
            <p>This is the most critical and immediate risk identified in your plan. The strategic plan recommends low-risk debt categories ('Corporate Bond', 'Short Duration'). However, analysis of available funds highlighted an option from the 'Credit Risk' category. These funds intentionally invest in lower-rated corporate bonds to seek higher returns. This introduces a significantly higher risk of default, where the bond issuer fails to repay its debt, which could lead to a permanent loss of your invested capital. Allocating 50% of your portfolio to this category would fundamentally alter your plan's risk profile from 'moderate' to 'aggressive', which is a serious deviation that requires your explicit consent or correction.</p>
        </div>
        <h3>General Risks</h3>
        <p><strong>Market Risk:</strong> The projected 10% annual return is an estimate, not a guarantee. Equity and debt markets are inherently volatile and can be influenced by economic conditions, interest rate changes, regulatory policies, and geopolitical events. A market downturn could lead to the final corpus being lower than projected. Over a 5-year period, this risk is moderate but significant.</p>
        <p><strong>Inflation Risk:</strong> The plan assumes an average annual inflation rate of 5.5%. If the actual rate of inflation is higher over the next five years, the purchasing power of your final target corpus of INR 1.31 Crore will be eroded. This could mean that the accumulated amount is insufficient to cover the actual cost of your house purchase in the future.</p>
    </section>

    <!-- 9. SIP Charts -->
    <section id="sip-charts">
      <h2>üìä SIP Projection & Allocation Charts</h2>
      <div style="display: block;">
        <!-- Asset Allocation FIRST (TOP) -->
        <div class="chart-container" style="margin-bottom: 30px; text-align: center;">
          <h3>Asset Allocation</h3>
          <div style="max-width: 500px; margin: 0 auto;">
            <canvas id="sipAllocationChart" width="400" height="300" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
        
        <!-- SIP Growth Projection SECOND (BOTTOM) -->
        <div class="chart-container" style="text-align: center;">
          <h3>SIP Growth Projection</h3>
          <div style="max-width: 800px; margin: 0 auto;">
            <canvas id="sipProjectionChart" width="600" height="400" style="max-width: 100%; height: auto;"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- 10. Monthly Projection Table -->
    <section id="monthly-projection">
      <h2>üìà Monthly Projection (First 12 Months)</h2>
      <table>
        <thead>
          <tr><th>Month</th><th>Contribution</th><th>Cumulative Contribution</th><th>Projected Corpus</th></tr>
        </thead>
        <tbody id="projection-table-body">
          <!-- Rows will be inserted by script -->
        </tbody>
      </table>
    </section>

    <!-- 11. Print/Download Controls -->
    <div class="print-controls">
      <button onclick="window.print()">Print Report</button>
      <button onclick="downloadHTML()">Download HTML</button>
    </div>

  </div>

  <!-- Data Embedding -->
  <script id="chart-data" type="application/json">
    {"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60"],"datasets":{"cumulative_contribution":[168767.13,337534.26,506301.39,675068.52,843835.65,1012602.78,1181369.91,1350137.04,1518904.17,1687671.3,1856438.43,2025205.56,2193972.69,2362739.82,2531506.95,2700274.08,2869041.21,3037808.34,3206575.47,3375342.6,3544109.73,3712876.86,3881643.99,4050411.12,4219178.25,4387945.38,4556712.51,4725479.64,4894246.77,5063013.9,5231781.03,5400548.16,5569315.29,5738082.42,5906849.55,6075616.68,6244383.81,6413150.94,6581918.07,6750685.2,6919452.33,7088219.46,7256986.59,7425753.72,7594520.85,7763287.98,7932055.11,8100822.24,8269589.37,8438356.5,8607123.63,8775890.76,8944657.89,9113425.02,9282192.15,9450959.28,9619726.41,9788493.54,9957260.67,10126027.8],"projected_corpus":[168767.13,338940.65,510532.29,683553.76,858016.91,1033933.72,1211316.27,1390176.71,1570527.35,1752380.59,1935748.91,2120644.92,2307081.33,2495070.97,2684626.79,2875761.85,306849.26,3262822.25,3458774.22,3656358.67,3855589.22,4056479.48,4259043.14,4463293.97,4669245.92,4876913.04,5086309.52,5297449.69,5510347.97,5725018.91,5941477.1,6159737.14,6379813.68,6601721.49,6825475.49,7051090.79,7278582.58,7507966.14,7739256.88,7972470.36,8207622.25,8444728.32,8683804.42,8924866.49,9167930.56,9413012.75,9660129.28,9909296.53,10160531.03,10413849.49,10669268.61,10926805.15,11186475.92,11448297.88,11712288.08,11978463.66,12246841.86,12517439.88,12790275.05,13065364.84]}},"allocation":{"labels":["Equity","Debt"],"data":[50,50]}}
  </script>
  <script id="table-data" type="application/json">
    [{"month_index":1,"label":"M1","contribution":168767.13,"cumulative_contribution":168767.13,"projected_corpus":168767.13},{"month_index":2,"label":"M2","contribution":168767.13,"cumulative_contribution":337534.26,"projected_corpus":338940.65},{"month_index":3,"label":"M3","contribution":168767.13,"cumulative_contribution":506301.39,"projected_corpus":510532.29},{"month_index":4,"label":"M4","contribution":168767.13,"cumulative_contribution":675068.52,"projected_corpus":683553.76},{"month_index":5,"label":"M5","contribution":168767.13,"cumulative_contribution":843835.65,"projected_corpus":858016.91},{"month_index":6,"label":"M6","contribution":168767.13,"cumulative_contribution":1012602.78,"projected_corpus":1033933.72},{"month_index":7,"label":"M7","contribution":168767.13,"cumulative_contribution":1181369.91,"projected_corpus":1211316.27},{"month_index":8,"label":"M8","contribution":168767.13,"cumulative_contribution":1350137.04,"projected_corpus":1390176.71},{"month_index":9,"label":"M9","contribution":168767.13,"cumulative_contribution":1518904.17,"projected_corpus":1570527.35},{"month_index":10,"label":"M10","contribution":168767.13,"cumulative_contribution":1687671.3,"projected_corpus":1752380.59},{"month_index":11,"label":"M11","contribution":168767.13,"cumulative_contribution":1856438.43,"projected_corpus":1935748.91},{"month_index":12,"label":"M12","contribution":168767.13,"cumulative_contribution":2025205.56,"projected_corpus":2120644.92}]
  </script>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Chart Rendering Script -->
  <script>
    function initCharts() {
      if (typeof Chart === 'undefined') {
        console.error('Chart.js not loaded');
        return;
      }
      
      let data;
      try {
        const script = document.getElementById('chart-data');
        data = script ? JSON.parse(script.textContent) : null;
      } catch (e) {
        console.warn('Chart data parse failed');
        data = null;
      }
      
      // Enhanced fallback with a complete timeline
      if (!data) {
        console.log('Using fallback data for charts.');
        data = {
          projection: { labels: ["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60"], datasets: { cumulative_contribution: [1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,17000,18000,19000,20000,21000,22000,23000,24000,25000,26000,27000,28000,29000,30000,31000,32000,33000,34000,35000,36000,37000,38000,39000,40000,41000,42000,43000,44000,45000,46000,47000,48000,49000,50000,51000,52000,53000,54000,55000,56000,57000,58000,59000,60000], projected_corpus: [1008,2024,3048,4080,5121,6170,7227,8293,9368,10451,11543,12644,13754,14873,16002,17140,18287,19444,20610,21786,22972,24168,25374,26590,27817,29054,30301,31559,32828,34107,35397,36698,38010,39333,40667,42013,43370,44738,46118,47510,48914,50329,51757,53196,54648,56111,57587,59075,60575,62088,63614,65152,66703,68267,69844,71434,73037,74653,76283,77926] } },
          allocation: { labels: ["Equity", "Debt"], data: [50, 50] }
        };
      }
      
      // Create allocation chart FIRST (TOP POSITION)
      const allocCtx = document.getElementById('sipAllocationChart');
      if (allocCtx) {
        new Chart(allocCtx, {
          type: 'doughnut',
          data: {
            labels: data.allocation.labels,
            datasets: [{ data: data.allocation.data, backgroundColor: ['#3B82F6', '#10B981'], borderWidth: 2 }]
          },
          options: { responsive: true, maintainAspectRatio: true, aspectRatio: 1.33, plugins: { legend: { position: 'bottom', labels: { padding: 15 } } } }
        });
      }
      
      // Create projection chart SECOND (BOTTOM POSITION)
      const projCtx = document.getElementById('sipProjectionChart');
      if (projCtx) {
        new Chart(projCtx, {
          type: 'line',
          data: {
            labels: data.projection.labels,
            datasets: [{
              label: 'Projected Corpus',
              data: data.projection.datasets.projected_corpus,
              borderColor: '#3B82F6',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              fill: true,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }, {
              label: 'Cumulative Contribution', 
              data: data.projection.datasets.cumulative_contribution,
              borderColor: '#EF4444',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              fill: false,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.5,
            interaction: { mode: 'nearest', intersect: false },
            scales: {
              x: { title: { display: true, text: 'Time Period (Months)' }, ticks: { maxTicksLimit: 12 } },
              y: { beginAtZero: true, title: { display: true, text: 'Amount (INR)' }, ticks: { callback: function(value) { return '‚Çπ' + (value/100000).toFixed(1) + 'L'; } } }
            },
            plugins: { tooltip: { mode: 'index', intersect: false } }
          }
        });
      }
    }

    function populateTable() {
      let data;
      try {
        const script = document.getElementById('table-data');
        data = script ? JSON.parse(script.textContent) : [];
      } catch (e) {
        console.warn('Table data parse failed');
        data = [];
      }
      const tableBody = document.getElementById('projection-table-body');
      if (!tableBody) return;
      if (data.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="4" style="text-align: center;">Projection data not available.</td></tr>';
        return;
      }
      const formatter = new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0 });
      data.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${row.label}</td><td>${formatter.format(row.contribution)}</td><td>${formatter.format(row.cumulative_contribution)}</td><td>${formatter.format(row.projected_corpus)}</td>`;
        tableBody.appendChild(tr);
      });
    }
    
    function downloadHTML() {
      const html = document.documentElement.outerHTML;
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'sip_report.html';
      a.click();
      URL.revokeObjectURL(url);
    }

    // Initialize with a short delay for proper loading
    document.addEventListener('DOMContentLoaded', function() {
        populateTable();
        setTimeout(initCharts, 200);
    });
  </script>

</body>
</html>