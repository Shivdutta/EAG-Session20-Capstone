<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comprehensive Investment Report</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 20px; background-color: #f9fafb; color: #1f2937; }
    .container { max-width: 1200px; margin: 0 auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    h1 { font-size: 2.25rem; font-weight: bold; color: #111827; border-bottom: 2px solid #3B82F6; padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
    h2 { font-size: 1.5rem; font-weight: bold; color: #111827; margin-top: 2rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid #e5e7eb; }
    table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
    th { background-color: #f8f9fa; font-weight: 600; }
    p { line-height: 1.6; margin-bottom: 1rem; }
    ul, ol { margin-left: 1.5rem; margin-bottom: 1rem; }
    li { margin-bottom: 0.5rem; }
    .executive-summary { background-color: #eff6ff; border-left: 4px solid #3B82F6; padding: 1.5rem; margin-bottom: 2rem; border-radius: 4px; }
    .callout { padding: 1rem; margin: 1.5rem 0; border-radius: 4px; border-left-width: 4px; }
    .callout.warning { background-color: #fffbeb; border-color: #f59e0b; color: #92400e; }
    .callout.highlight { background-color: #f0f9ff; border-color: #38bdf8; color: #075985; }
    .no-print { display: block; }
    @media print {
      .no-print { display: none; }
      body { padding: 0; background-color: #fff; }
      .container { box-shadow: none; border: none; padding: 0.5rem; }
      h1, h2 { margin-top: 1.5rem; }
      section { page-break-inside: avoid; }
      .chart-container { page-break-inside: avoid !important; margin: 15px 0; box-shadow: none; }
      canvas { max-height: 280px !important; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Comprehensive Retirement Financial Plan</h1>
    
    <section id="executive-summary">
      <div class="executive-summary">
        <h2>üéØ Executive Summary</h2>
        <p>This report outlines a strategic financial plan designed to achieve the retirement goal of accumulating a target corpus of <b>‚Çπ10,000,000</b> in today's value over a 10-year horizon. Factoring in an annual inflation rate of 5.5%, the future value of this goal is calculated to be <b>‚Çπ17,081,444.58</b>. To reach this inflation-adjusted target, a monthly Systematic Investment Plan (SIP) of <b>‚Çπ83,387.19</b> is required, assuming a 10% annualized return consistent with a 'moderate' risk profile. The proposed asset allocation is a balanced 50% in equity and 50% in debt.</p>
        <div class='callout warning'>‚ö†Ô∏è <strong>Critical Plan Validation Issues Identified:</strong><br>1. <b>Calculation Shortfall:</b> A validation check revealed that the final projected corpus of ‚Çπ16,980,074.49 falls short of the required ‚Çπ17,081,444.58 target by <b>‚Çπ101,370.09</b>. The plan requires recalculation to ensure the goal is met.<br>2. <b>Unverified Recommendations:</b> An upstream data retrieval failure means the recommended fund categories (e.g., Large Cap, Mid Cap) could not be validated against market performance data. Proceeding with these recommendations carries unquantified risk.</div>
        <p>This document provides a detailed breakdown of the calculations, asset allocation strategy, growth projections, and a thorough analysis of the risks and uncertainties involved. The plan should be considered provisional until the identified issues are fully remediated.</p>
      </div>
    </section>

    <section id='goal-inputs'>
      <h2>üìã Goal Inputs & Assumptions</h2>
      <p>The foundation of this financial plan is based on the following user-defined inputs and derived parameters.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Goal Type</td><td>Retirement</td></tr><tr><td>Current Age</td><td>50 years</td></tr><tr><td>Target Retirement Age</td><td>60 years</td></tr><tr><td>Time Horizon</td><td>10 years (120 months)</td></tr><tr><td>Target Amount (Present Value)</td><td>‚Çπ10,000,000</td></tr><tr><td>Risk Appetite</td><td>Moderate</td></tr><tr><td>Assumed Annual Return</td><td>10.00%</td></tr></tbody></table>
    </section>

    <section id='inflation-adjustment'>
      <h2>üí® Inflation Adjustment Analysis</h2>
      <p>To preserve purchasing power, the target corpus must be adjusted for inflation over the investment horizon.</p>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Assumed Annual Inflation Rate</td><td>5.5%</td></tr><tr><td>Investment Horizon</td><td>10 years</td></tr><tr><td>Unadjusted Target Corpus</td><td>‚Çπ10,000,000.00</td></tr><tr><td><b>Inflation-Adjusted Target Corpus (Future Value)</b></td><td><b>‚Çπ17,081,444.58</b></td></tr></tbody></table>
    </section>

    <section id='sip-calculation'>
      <h2>‚öôÔ∏è SIP Contribution Calculation</h2>
      <div class='callout highlight'>This calculation is the theoretical requirement. The projection table in a later section shows a minor discrepancy that must be addressed.</div>
      <table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Inflation-Adjusted Target</td><td>‚Çπ17,081,444.58</td></tr><tr><td>Number of Months (n)</td><td>120</td></tr><tr><td>Assumed Monthly Rate of Return (r)</td><td>0.8333%</td></tr><tr><td><b>Required Monthly SIP</b></td><td><b>‚Çπ83,387.19</b></td></tr></tbody></table>
    </section>

    <section id='asset-allocation'>
      <h2>üß© Asset Allocation Plan</h2>
      <p>Based on a 'moderate' risk profile, a balanced allocation between equity and debt is recommended to balance growth potential with capital preservation.</p>
      <table><thead><tr><th>Asset Class</th><th>Allocation</th><th>Recommended Fund Categories</th></tr></thead><tbody><tr><td>Equity</td><td>50%</td><td>Large Cap Funds, Mid Cap Funds</td></tr><tr><td>Debt</td><td>50%</td><td>Corporate Bond Funds, Short Duration Funds</td></tr></tbody></table>
      <div class='callout warning'><strong>Data Retrieval Failure:</strong> The suitability of the specific fund categories listed could not be confirmed due to a critical failure in fetching market performance data. These recommendations are currently unverified.</div>
    </section>

    <section id='key-recommendations'>
      <h2>üîë Key Recommendations</h2>
      <ol><li><b>Critical: Correct Projection Calculation.</b> The SIP projection logic must be revised to ensure the final corpus at month 120 precisely matches the inflation-adjusted target of ‚Çπ17,081,444.58, eliminating the current shortfall of ‚Çπ101,370.09.</li><li><b>Critical: Halt and Remediate Data Retrieval.</b> Immediately halt the investment planning workflow. The upstream market data retrieval process must be debugged to resolve the fetching errors before any fund selection is made.</li><li><b>High: Treat Plan as Provisional.</b> Consider the current plan a strategic draft. Do not proceed with any capital allocation based on the unverified fund category recommendations until successful data validation is complete.</li></ol>
    </section>

    <section id='risks-uncertainties'>
      <h2>‚öñÔ∏è Risk Factors and Uncertainties</h2>
      <p>This financial plan, while based on systematic calculations, is subject to several risks and uncertainties that must be understood before implementation. The primary risks are categorized into two groups: plan-specific issues and general market risks.</p>
      <p><b>Plan-Specific Issues:</b><br>The most immediate risks are internal to this plan's generation. The <b>0.59% projection shortfall</b> is a critical calculation error; if uncorrected, it guarantees the goal will be missed. Furthermore, the <b>unverified fund categories</b> present a significant unknown. Without performance and volatility data, there is no evidence that these categories can deliver the required 10% return, potentially jeopardizing the entire plan. Proceeding is not advised.</p>
      <p><b>General Market Risks:</b><br>Beyond these issues, the plan is exposed to standard investment risks. <i>Market Volatility</i> is inherent in equity investments; returns are not linear and can vary significantly, potentially underperforming the 10% assumption. <i>Inflation Risk</i> is another major factor; should the actual inflation rate exceed the projected 5.5%, the real value of the final corpus will be lower than intended. Finally, there is <i>Execution Risk</i>, which involves the investor's discipline to consistently invest the required SIP amount every month for 120 months without interruption, regardless of market conditions. Any deviation from the plan will impact the final outcome.</p>
    </section>

    <section id="sip-charts">
        <h2>üìä SIP Projection & Allocation Charts</h2>
        <div style="display: block; max-width: 1000px; margin: 0 auto;">
            <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
                <h3 style="margin-bottom: 15px; font-size: 1.1rem; font-weight: 600;">Asset Allocation</h3>
                <div style="max-width: 500px; margin: 0 auto;">
                    <canvas id="sipAllocationChart" width="400" height="300" style="max-width: 100%; height: auto;"></canvas>
                </div>
            </div>
            <div class="chart-container" style="margin-bottom: 30px; text-align: center; border: 1px solid #e5e7eb; padding: 20px; border-radius: 8px;">
                <h3 style="margin-bottom: 15px; font-size: 1.1rem; font-weight: 600;">SIP Growth Projection</h3>
                <div style="max-width: 800px; margin: 0 auto;">
                    <canvas id="sipProjectionChart" width="600" height="400" style="max-width: 100%; height: auto;"></canvas>
                </div>
            </div>
        </div>
    </section>

    <section id="monthly-projection">
        <h2>üìà Monthly Projection (First 12 Months)</h2>
        <p>The table below provides a month-by-month breakdown of the investment growth over the first year. The complete 120-month projection is visualized in the line chart above.</p>
        <table><thead><tr><th>Month</th><th>Cumulative Contribution</th><th>Projected Corpus Value</th></tr></thead><tbody><tr><td>M1</td><td>‚Çπ83,387.19</td><td>‚Çπ84,081.75</td></tr><tr><td>M2</td><td>‚Çπ166,774.38</td><td>‚Çπ168,864.51</td></tr><tr><td>M3</td><td>‚Çπ250,161.57</td><td>‚Çπ254,353.94</td></tr><tr><td>M4</td><td>‚Çπ333,548.76</td><td>‚Çπ340,555.72</td></tr><tr><td>M5</td><td>‚Çπ416,935.95</td><td>‚Çπ427,475.58</td></tr><tr><td>M6</td><td>‚Çπ500,323.14</td><td>‚Çπ515,119.28</td></tr><tr><td>M7</td><td>‚Çπ583,710.33</td><td>‚Çπ603,492.61</td></tr><tr><td>M8</td><td>‚Çπ667,097.52</td><td>‚Çπ692,601.40</td></tr><tr><td>M9</td><td>‚Çπ750,484.71</td><td>‚Çπ782,451.48</td></tr><tr><td>M10</td><td>‚Çπ833,871.90</td><td>‚Çπ873,048.74</td></tr><tr><td>M11</td><td>‚Çπ917,259.09</td><td>‚Çπ964,399.11</td></tr><tr><td>M12</td><td>‚Çπ1,000,646.28</td><td>‚Çπ1,056,508.53</td></tr></tbody></table>
    </section>

    <div style="margin: 40px 0; text-align: center;" class="no-print">
      <button onclick="window.print()" style="margin: 5px; padding: 12px 24px; background-color: #3B82F6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Print Report</button>
      <button onclick="downloadHTML()" style="margin: 5px; padding: 12px 24px; background-color: #10B981; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500;">Download HTML</button>
    </div>

  </div>

  <script id="chart-data" type="application/json">
  {"projection":{"labels":["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24","M25","M26","M27","M28","M29","M30","M31","M32","M33","M34","M35","M36","M37","M38","M39","M40","M41","M42","M43","M44","M45","M46","M47","M48","M49","M50","M51","M52","M53","M54","M55","M56","M57","M58","M59","M60","M61","M62","M63","M64","M65","M66","M67","M68","M69","M70","M71","M72","M73","M74","M75","M76","M77","M78","M79","M80","M81","M82","M83","M84","M85","M86","M87","M88","M89","M90","M91","M92","M93","M94","M95","M96","M97","M98","M99","M100","M101","M102","M103","M104","M105","M106","M107","M108","M109","M110","M111","M112","M113","M114","M115","M116","M117","M118","M119","M120"],"datasets":{"cumulative_contribution":[83387.19,166774.38,250161.57,333548.76,416935.95,500323.14,583710.33,667097.52,750484.71,833871.9,917259.09,1000646.28,1084033.47,1167420.66,1250807.85,1334195.04,1417582.23,1500969.42,1584356.61,1667743.8,1751130.99,1834518.18,1917905.37,2001292.56,2084679.75,2168066.94,2251454.13,2334841.32,2418228.51,2501615.7,2585002.89,2668390.08,2751777.27,2835164.46,2918551.65,3001938.84,3085326.03,3168713.22,3252100.41,3335487.6,3418874.79,3502261.98,3585649.17,3669036.36,3752423.55,3835810.74,3919197.93,4002585.12,4085972.31,4169359.5,4252746.69,4336133.88,4419521.07,4502908.26,4586295.45,4669682.64,4753069.83,4836457.02,4919844.21,5003231.4,5086618.59,5170005.78,5253392.97,5336780.16,5420167.35,5503554.54,5586941.73,5670328.92,5753716.11,5837103.3,5920490.49,6003877.68,6087264.87,6170652.06,6254039.25,6337426.44,6420813.63,6504200.82,6587588.01,6670975.2,6754362.39,6837749.58,6921136.77,7004523.96,7087911.15,7171298.34,7254685.53,7338072.72,7421459.91,7504847.1,7588234.29,7671621.48,7755008.67,7838395.86,7921783.05,8005170.24,8088557.43,8171944.62,8255331.81,8338719.0,8422106.19,8505493.38,8588880.57,8672267.76,8755654.95,8839042.14,8922429.33,9005816.52,9089203.71,9172590.9,9255978.09,9339365.28,9422752.47,9506139.66,9589526.85,9672914.04,9756301.23,9839688.42,9923075.61,10006462.8],"projected_corpus":[84081.75,168864.51,254353.94,340555.72,427475.58,515119.28,603492.61,692601.4,782451.48,873048.74,964399.11,1056508.53,1149383.04,1243028.61,1337451.27,1432657.1,1528652.21,1625442.76,1723034.98,1821435.12,1920649.49,2020684.49,2121546.5,2223241.95,2325777.3,2429159.08,2533393.84,2638488.16,2744448.66,2851282.02,2958994.94,3067594.13,3177086.38,3287478.47,3398777.23,3510989.54,3624122.31,3738182.49,3853177.05,3969113.01,4085997.43,4203837.4,4322640.01,4442412.38,4563161.68,4684895.12,4807619.92,4931343.34,5056072.71,5181815.34,5308578.58,5436369.83,5565196.58,5695066.36,5825986.74,5957965.34,6091009.84,6225128.0,6360327.53,6496616.16,6634001.63,6772491.81,6912094.57,7052817.84,7194669.56,7337657.69,7481790.2,7627075.12,7773520.51,7921134.48,8069925.26,8219901.14,8371069.98,8523439.86,8677018.9,8831815.22,8987837.05,9145092.7,9303590.51,9463338.8,9624345.92,9786620.27,9950170.27,10115004.42,10281131.12,10448559.04,10617296.87,10787353.38,10958737.36,11131457.64,11305523.12,11480942.82,11657725.71,11835880.93,12015417.6,12196344.88,12378671.95,12562407.95,12747562.05,12934143.43,13122161.32,13311625.0,13502543.84,13694927.24,13888784.63,14084125.5,14280959.38,14479295.84,14679144.51,14880515.01,15083416.97,15287860.11,15493854.26,15701409.28,15910535.09,16121241.58,16333538.73,16547436.52,16762945.02,16980074.49]}},"allocation":{"labels":["Equity","Debt"],"data":[50,50]}}
  </script>

  <script>
    function downloadHTML() {
      const html = document.documentElement.outerHTML;
      const blob = new Blob([html], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'comprehensive_report.html';
      a.click();
      URL.revokeObjectURL(url);
    }

    function initCharts() {
      if (typeof Chart === 'undefined') {
        console.error('Chart.js not loaded');
        return;
      }
      let data;
      try {
        const script = document.getElementById('chart-data');
        data = script ? JSON.parse(script.textContent) : null;
      } catch (e) {
        console.warn('Chart data parse failed');
        data = null;
      }
      if (!data) {
        console.error('Fallback needed: Chart data not found or invalid.');
        return;
      }

      const allocCtx = document.getElementById('sipAllocationChart');
      if (allocCtx) {
        new Chart(allocCtx, {
          type: 'doughnut',
          data: {
            labels: data.allocation.labels,
            datasets: [{ 
              data: data.allocation.data, 
              backgroundColor: ['#3B82F6', '#10B981'],
              borderWidth: 2 
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.33,
            plugins: {
              legend: { position: 'bottom', labels: { padding: 15 } }
            }
          }
        });
      }

      const projCtx = document.getElementById('sipProjectionChart');
      if (projCtx) {
        new Chart(projCtx, {
          type: 'line',
          data: {
            labels: data.projection.labels,
            datasets: [{
              label: 'Projected Corpus',
              data: data.projection.datasets.projected_corpus,
              borderColor: '#3B82F6',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              fill: true,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }, {
              label: 'Cumulative Contribution', 
              data: data.projection.datasets.cumulative_contribution,
              borderColor: '#EF4444',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              fill: false,
              tension: 0.4,
              pointRadius: 1,
              pointHoverRadius: 4
            }]
          },
          options: { 
            responsive: true,
            maintainAspectRatio: true,
            aspectRatio: 1.5,
            interaction: { mode: 'nearest', intersect: false },
            scales: {
              x: { title: { display: true, text: 'Time Period (Months)' }, ticks: { maxTicksLimit: 12 } },
              y: { beginAtZero: true, title: { display: true, text: 'Amount (INR)' }, ticks: { callback: function(value) { return '‚Çπ' + (value/100000).toFixed(1) + 'L'; } } }
            },
            plugins: { tooltip: { mode: 'index', intersect: false } }
          }
        });
      }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() { setTimeout(initCharts, 300); });
    } else {
        setTimeout(initCharts, 300);
    }
  </script>
</body>
</html>