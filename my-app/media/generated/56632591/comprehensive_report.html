<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive SIP Analysis Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        .chart-container {
            width: 100%;
            margin-bottom: 20px;
        }
        @media print {
            body {
                font-size: 12pt;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-8">

    <div class="container mx-auto bg-white shadow-md rounded-md p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-semibold">Comprehensive SIP Analysis Report</h1>
        </header>

        <section id="executive_summary" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Executive Summary</h2>
            <p>This report outlines the key findings and recommendations for a SIP goal focused on child marriage, with a target amount yet to be determined. The analysis includes inflation adjustment, SIP calculation, and asset allocation guidance. Due to the missing target amount, several calculations and projections are currently placeholders. The report aims to provide actionable insights for investors and entrepreneurs once the target amount is specified.</p>
        </section>

        <section id="goal_inputs" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Goal Inputs</h2>
            <p>The goal is to plan a SIP for child marriage with the following inputs:</p>
            <ul>
                <li><b>Goal Type:</b> Child Marriage</li>
                <li><b>Target Amount:</b> To be specified</li>
                <li><b>Currency:</b> INR</li>
                <li><b>Time Horizon:</b> 7 years (84 months)</li>
                <li><b>Risk Appetite:</b> Moderate</li>
            </ul>
        </section>

        <section id="inflation_adjustment" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Inflation Adjustment</h2>
            <p>Inflation adjustment is calculated based on the following parameters:</p>
            <ul>
                <li><b>Inflation Rate:</b> 5.5% annually</li>
                <li><b>Time Horizon:</b> 7 years</li>
                <li><b>Unadjusted Target Amount:</b> To be specified</li>
                <li><b>Adjusted Target Amount:</b> To be calculated once the target amount is provided</li>
            </ul>
        </section>

        <section id="sip_calculation" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">SIP Calculation</h2>
            <p>SIP calculation is performed based on the following parameters:</p>
            <ul>
                <li><b>Monthly Return Rate (r):</b> 0.00833 (10% annually)</li>
                <li><b>Number of Months (n):</b> 84</li>
                <li><b>Adjusted Target Amount:</b> To be calculated once the target amount is provided</li>
                <li><b>Monthly SIP Amount:</b> To be calculated once the target amount is provided</li>
            </ul>
            <p><b>Status:</b> Error - Target amount is not defined, cannot calculate the monthly SIP amount. Consequently, the SIP projection table and related metrics are currently unavailable.</p>
        </section>

        <section id="asset_allocation_plan" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Asset Allocation Plan</h2>
            <p>The asset allocation plan is designed based on a moderate risk appetite, with the following allocation:</p>
            <ul>
                <li><b>Equity:</b> 50%</li>
                <li><b>Debt:</b> 50%</li>
            </ul>
            <p><b>Recommended Fund Categories:</b></p>
            <ul>
                <li><b>Equity:</b> Large Cap Funds, Mid Cap Funds, Small Cap Funds, ELSS Tax Saver Funds</li>
                <li><b>Debt:</b> Corporate Bond Funds, Short Duration Funds, Liquid Funds, Government Securities</li>
                <li><b>ELSS Optional:</b> True</li>
            </ul>
        </section>

        <section id="allocation_notes" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Allocation Notes</h2>
            <p>The following notes provide guidance on different risk policies:</p>
            <ul>
                <li><b>Very Low:</b> Extremely conservative, e.g., 90% debt / 10% equity</li>
                <li><b>Low:</b> Conservative, e.g., 70% debt / 30% equity</li>
                <li><b>Low-Moderate:</b> Tilted conservative, e.g., 60% debt / 40% equity</li>
                <li><b>Moderate:</b> Balanced mix, e.g., 50% equity / 50% debt</li>
                <li><b>High-Moderate:</b> Tilted aggressive, e.g., 60% equity / 40% debt</li>
                <li><b>High:</b> Aggressive, e.g., 70% equity / 30% equity</li>
                <li><b>Very High:</b> Extremely aggressive, e.g., 90% equity / 10% debt</li>
            </ul>
        </section>

        <section id="key_recommendations" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Key Recommendations</h2>
            <p>Based on the current analysis, the following recommendations are made:</p>
            <ol>
                <li><b>Specify the Target Amount:</b> Provide a specific target amount to enable accurate SIP calculations and projections.</li>
                <li>Confirm that the investor understands the specific risk/return characteristics of the selected fund categories (e.g., Mid Cap vs. Large Cap).</li>
                <li>Expand the fund search to ensure a more comprehensive representation of available investment options, addressing the 'partial' content completeness issue in T012.</li>
                <li>Emphasize the importance of long-term investment strategy and avoid overemphasizing short-term fund performance.</li>
            </ol>
        </section>

        <section id="risk_factors_uncertainties" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Risk Factors and Uncertainties</h2>
            <p>Investing in financial markets involves inherent risks and uncertainties that can significantly impact the performance of investments. Understanding these risks is crucial for making informed decisions and managing potential losses. Some of the key risk factors and uncertainties associated with SIP investments include:</p>
            <ul>
                <li><b>Market Risk:</b> The value of investments can fluctuate due to market volatility, economic conditions, and geopolitical events. Equity investments are particularly susceptible to market risk, as stock prices can be highly unpredictable. For example, a sudden market crash can significantly reduce the value of equity fund holdings.</li>
                <li><b>Inflation Risk:</b> Inflation can erode the purchasing power of returns, especially over long investment horizons. It is essential to consider inflation-adjusted returns when evaluating the performance of investments. If the inflation rate exceeds the investment return, the real value of the investment may decrease.</li>
                <li><b>Interest Rate Risk:</b> Changes in interest rates can impact the value of fixed-income investments, such as bonds. Rising interest rates can lead to a decrease in bond prices, while falling interest rates can increase bond prices. If interest rates rise, the value of existing bonds in a debt fund may decline.</li>
                <li><b>Credit Risk:</b> Credit risk refers to the possibility that a borrower may default on its debt obligations. Corporate bonds and other debt instruments are subject to credit risk, as the issuer may face financial difficulties and be unable to repay the principal or interest. A downgrade in the credit rating of a corporate bond can lead to a decrease in its market value.</li>
                <li><b>Liquidity Risk:</b> Liquidity risk refers to the difficulty of selling an investment quickly at a fair price. Some investments may be less liquid than others, making it challenging to exit a position when needed. Small-cap funds may have lower liquidity compared to large-cap funds.</li>
                <li><b>Regulatory Risk:</b> Changes in regulations and government policies can impact the financial markets and investment performance. Regulatory risk is particularly relevant in sectors that are heavily regulated, such as finance and healthcare. Changes in tax laws or investment regulations can affect the returns from SIP investments.</li>
                <li><b>Currency Risk:</b> Currency risk arises when investing in international markets, as exchange rate fluctuations can impact the value of returns. Currency risk can be mitigated by hedging currency exposure or investing in domestic assets. Fluctuations in the exchange rate between INR and other currencies can affect the returns from international funds.</li>
                <li><b>Economic Risk:</b> Economic factors, such as recessions, inflation, and unemployment, can significantly impact investment performance. Economic risk is particularly relevant for businesses that are highly sensitive to economic cycles. A recession can lead to lower corporate earnings and reduced investment returns.</li>
                <li><b>Geopolitical Risk:</b> Geopolitical events, such as wars, political instability, and trade disputes, can create uncertainty and volatility in the financial markets. Geopolitical risk is often difficult to predict and can have a significant impact on investment returns. Trade tensions between countries can affect the performance of export-oriented industries.</li>
            </ul>
            <p>It is important to note that these are just some of the many risk factors and uncertainties that can affect investment performance. Investors should carefully consider their risk tolerance, investment objectives, and time horizon when making investment decisions. Diversification and professional financial advice can help mitigate some of these risks. <b>Crucially, the absence of a defined target amount introduces significant uncertainty into the SIP planning process, making it difficult to accurately project future investment outcomes.</b></p>
        </section>

        <section id="sip_charts" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">SIP Projection & Allocation Charts</h2>
            <div class="charts-grid">
                <div class="chart-container">
                    <h3>SIP Growth Projection</h3>
                    <canvas id="sipProjectionChart" width="400" height="300"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Asset Allocation</h3>
                    <canvas id="sipAllocationChart" width="400" height="300"></canvas>
                </div>
            </div>
        </section>

        <section id="sip_projection_long_horizon" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">SIP Projection Summary (First 12 Months)</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>Cumulative Contribution</th>
                            <th>Projected Corpus</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Data not available</td>
                            <td>Data not available</td>
                            <td>Data not available</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section id="missing_target_amount" class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Missing Target Amount: Impact and Next Steps</h2>
            <p>The absence of a specified target amount significantly impacts the SIP planning process. Without this crucial input, it is impossible to calculate the required monthly SIP amount, project future investment growth accurately, or provide tailored investment recommendations. The SIP calculation section highlights the error status resulting from the missing target amount, and the SIP projection table remains unavailable. <b>Please provide the target amount to proceed with a complete and accurate SIP analysis.</b></p>
        </section>

        <section id="disclaimer" class="mt-8">
            <h2 class="text-xl font-semibold mb-2">Disclaimer</h2>
            <p class="text-sm text-gray-500">
                This report is for informational purposes only and does not constitute financial advice. Investment decisions should be made based on your own research and consultation with a financial advisor. Past performance is not indicative of future results. The calculations and projections in this report are based on assumptions and estimates, which may not be accurate.
            </p>
        </section>

        <div class="no-print mt-8 text-center">
            <button onclick="window.print()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-4">Print Report</button>
            <button onclick="downloadReport()" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Download HTML</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script id="sip-data" type="application/json">{"projection":{"labels":[],"datasets":{"cumulative_contribution":[],"projected_corpus":[]}},"allocation":{"labels":["Equity","Debt"],"data":[50,50],"meta":{"recommended_fund_categories":{"equity":["Large Cap Funds","Mid Cap Funds","Small Cap Funds","ELSS Tax Saver Funds"],"debt":["Corporate Bond Funds","Short Duration Funds","Liquid Funds","Government Securities"],"elss_optional":true}}}}</script>
    <script id="goal-input-json" type="application/json">{"goal_type": "Child Marriage", "target_amount": null, "currency": "INR", "time_horizon_years": 7, "total_months": 84, "risk_appetite": "moderate"}</script>
    <script id="inflation-adjusted-json" type="application/json">{"inflation_pct": 5.5, "years": 7, "unadjusted_target": null, "adjusted_target": null}</script>
    <script id="sip-calc-json" type="application/json">{"monthly_return_r": 0.00833, "months_n": 84, "adjusted_target": null, "monthly_sip": null, "status": "error", "error": "Target amount is not defined, cannot calculate the monthly SIP amount."}</script>
    <script id="allocation-plan-json" type="application/json">{"equity_percent": 50, "debt_percent": 50, "recommended_fund_categories": {"equity": ["Large Cap Funds", "Mid Cap Funds", "Small Cap Funds", "ELSS Tax Saver Funds"], "debt": ["Corporate Bond Funds", "Short Duration Funds", "Liquid Funds", "Government Securities"], "elss_optional": true}, "notes": {"very_low": "Extremely conservative, e.g., 90% debt / 10% equity", "low": "Conservative, e.g., 70% debt / 30% equity", "low_moderate": "Tilted conservative, e.g., 60% debt / 40% equity", "moderate": "Balanced mix, e.g., 50% equity / 50% debt", "high_moderate": "Tilted aggressive, e.g., 60% equity / 40% debt", "high": "Aggressive, e.g., 70% equity / 30% debt", "very_high": "Extremely aggressive, e.g., 90% equity / 10% debt"}}</script>
    <script id="report-payload" type="application/json">{}</script>

    <script>
        function initializeCharts() {
            try {
                // Check if Chart.js is loaded
                if (typeof Chart === 'undefined') {
                    console.error('Chart.js not loaded');
                    return;
                }

                // Get chart data with robust error handling
                let chartData;
                try {
                    const dataScript = document.getElementById('sip-data');
                    if (dataScript && dataScript.textContent.trim()) {
                        chartData = JSON.parse(dataScript.textContent);
                    }
                } catch (e) {
                    console.warn('Failed to parse chart data, using fallbacks:', e);
                }

                // Robust fallback data
                if (!chartData) {
                    chartData = {
                        projection: {
                            labels: ["M1", "M2", "M3", "M4", "M5", "M6", "M7", "M8", "M9", "M10", "M11", "M12"],
                            datasets: {
                                cumulative_contribution: [240372, 480745, 721117, 961490, 1201862, 1442235, 1682607, 1922980, 2163352, 2403725, 2644097, 2884470],
                                projected_corpus: [242776, 485444, 730671, 978348, 1228504, 1481162, 1736346, 1994082, 2254395, 2517317, 2782872, 3051094]
                            }
                        },
                        allocation: {
                            labels: ["Equity", "Debt"],
                            data: [70, 30]
                        }
                    };
                }

                // Create projection chart with validation
                const projectionCtx = document.getElementById('sipProjectionChart');
                if (projectionCtx) {
                    new Chart(projectionCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: chartData.projection.labels || [],
                            datasets: [{
                                label: 'Projected Corpus',
                                data: chartData.projection.datasets.projected_corpus || [],
                                borderColor: 'rgb(75, 192, 192)',
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                fill: true,
                                tension: 0.4
                            }, {
                                label: 'Cumulative Contribution',
                                data: chartData.projection.datasets.cumulative_contribution || [],
                                borderColor: 'rgb(255, 99, 132)',
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                fill: false,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {display: true, text: 'Amount (INR)'},
                                    ticks: {
                                        callback: function (value) {
                                            return '\u20b9' + (value / 100000).toFixed(1) + 'L';
                                        }
                                    }
                                },
                                x: {
                                    title: {display: true, text: 'Time Period'}
                                }
                            }
                        }
                    });
                }

                // Create allocation chart with validation
                const allocationCtx = document.getElementById('sipAllocationChart');
                if (allocationCtx) {
                    new Chart(allocationCtx.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: chartData.allocation.labels || ['Equity', 'Debt'],
                            datasets: [{
                                data: chartData.allocation.data || [60, 40],
                                backgroundColor: ['#3B82F6', '#10B981'],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {padding: 20}
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function (context) {
                                            return context.label + ': ' + context.parsed + '%';
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

            } catch (error) {
                console.error('Chart initialization failed:', error);
                // Show error message in chart containers
                const projectionContainer = document.getElementById('sipProjectionChart');
                const allocationContainer = document.getElementById('sipAllocationChart');
                if (projectionContainer) {
                    projectionContainer.parentElement.innerHTML = '<p>Chart loading failed. Please refresh the page.</p>';
                }
                if (allocationContainer) {
                    allocationContainer.parentElement.innerHTML = '<p>Chart loading failed. Please refresh the page.</p>';
                }
            }
        }

        // Initialize charts when everything is ready with proper timing
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function () {
                setTimeout(initializeCharts, 200); // Increased delay to ensure Chart.js is ready
            });
        } else {
            setTimeout(initializeCharts, 200);
        }

        function downloadReport() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sip_analysis_report.html';
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>